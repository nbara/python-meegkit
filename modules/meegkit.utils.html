
<!DOCTYPE html>


<html lang="en" data-content_root="../" >

  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="viewport" content="width=device-width, initial-scale=1" />

    <title>meegkit.utils &#8212; MEEGkit 0.1.9 documentation</title>
  
  
  
  <script data-cfasync="false">
    document.documentElement.dataset.mode = localStorage.getItem("mode") || "";
    document.documentElement.dataset.theme = localStorage.getItem("theme") || "";
  </script>
  <!--
    this give us a css class that will be invisible only if js is disabled
  -->
  <noscript>
    <style>
      .pst-js-only { display: none !important; }

    </style>
  </noscript>
  
  <!-- Loaded before other Sphinx assets -->
  <link href="../_static/styles/theme.css?digest=8878045cc6db502f8baf" rel="stylesheet" />
<link href="../_static/styles/pydata-sphinx-theme.css?digest=8878045cc6db502f8baf" rel="stylesheet" />

    <link rel="stylesheet" type="text/css" href="../_static/pygments.css?v=8f2a1f02" />
    <link rel="stylesheet" type="text/css" href="../_static/jupyter-sphinx.css" />
    <link rel="stylesheet" type="text/css" href="../_static/thebelab.css" />
    <link rel="stylesheet" type="text/css" href="../_static/sg_gallery.css?v=d2d258e8" />
    <link rel="stylesheet" type="text/css" href="../_static/sg_gallery-binder.css?v=f4aeca0c" />
    <link rel="stylesheet" type="text/css" href="../_static/sg_gallery-dataframe.css?v=2082cf3c" />
    <link rel="stylesheet" type="text/css" href="../_static/sg_gallery-rendered-html.css?v=1277b6f3" />
  
  <!-- So that users can add custom icons -->
  <script src="../_static/scripts/fontawesome.js?digest=8878045cc6db502f8baf"></script>
  <!-- Pre-loaded scripts that we'll load fully later -->
  <link rel="preload" as="script" href="../_static/scripts/bootstrap.js?digest=8878045cc6db502f8baf" />
<link rel="preload" as="script" href="../_static/scripts/pydata-sphinx-theme.js?digest=8878045cc6db502f8baf" />

    <script src="../_static/documentation_options.js?v=8618f531"></script>
    <script src="../_static/doctools.js?v=9bcbadda"></script>
    <script src="../_static/sphinx_highlight.js?v=dc90522c"></script>
    <script src="../_static/thebelab-helper.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.4/require.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/@jupyter-widgets/html-manager@^1.0.1/dist/embed-amd.js"></script>
    <script async="async" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
    <script>DOCUMENTATION_OPTIONS.pagename = 'modules/meegkit.utils';</script>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
  <meta name="viewport" content="width=device-width, initial-scale=1"/>
  <meta name="docsearch:language" content="en"/>
  <meta name="docsearch:version" content="0.1.9" />
  </head>
  
  
  <body data-bs-spy="scroll" data-bs-target=".bd-toc-nav" data-offset="180" data-bs-root-margin="0px 0px -60%" data-default-mode="">

  
  
  <div id="pst-skip-link" class="skip-link d-print-none"><a href="#main-content">Skip to main content</a></div>
  
  <div id="pst-scroll-pixel-helper"></div>
  
  <button type="button" class="btn rounded-pill" id="pst-back-to-top">
    <i class="fa-solid fa-arrow-up"></i>Back to top</button>

  
  <dialog id="pst-search-dialog">
    
<form class="bd-search d-flex align-items-center"
      action="../search.html"
      method="get">
  <i class="fa-solid fa-magnifying-glass"></i>
  <input type="search"
         class="form-control"
         name="q"
         placeholder="Search the docs ..."
         aria-label="Search the docs ..."
         autocomplete="off"
         autocorrect="off"
         autocapitalize="off"
         spellcheck="false"/>
  <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd>K</kbd></span>
</form>
  </dialog>

  <div class="pst-async-banner-revealer d-none">
  <aside id="bd-header-version-warning" class="d-none d-print-none" aria-label="Version warning"></aside>
</div>

  
    <header class="bd-header navbar navbar-expand-lg bd-navbar d-print-none">
<div class="bd-header__inner bd-page-width">
  <button class="pst-navbar-icon sidebar-toggle primary-toggle" aria-label="Site navigation">
    <span class="fa-solid fa-bars"></span>
  </button>
  
  
  <div class="col-lg-3 navbar-header-items__start">
    
      <div class="navbar-item">

  
    
  

<a class="navbar-brand logo" href="../index.html">
  
  
  
  
  
    
    
      
    
    
    <img src="../_static/logo.png" class="logo__image only-light" alt=""/>
    <img src="../_static/logo-dark.png" class="logo__image only-dark pst-js-only" alt=""/>
  
  
    <p class="title logo__title">meegkit</p>
  
</a></div>
    
  </div>
  
  <div class="col-lg-9 navbar-header-items">
    
    <div class="me-auto navbar-header-items__center">
      
        <div class="navbar-item">
<nav>
  <ul class="bd-navbar-elements navbar-nav">
    
<li class="nav-item ">
  <a class="nav-link nav-internal" href="../auto_examples/index.html">
    Examples gallery
  </a>
</li>


<li class="nav-item ">
  <a class="nav-link nav-external" href="https://github.com/nbara/python-meegkit">
    GitHub
  </a>
</li>

  </ul>
</nav></div>
      
    </div>
    
    
    <div class="navbar-header-items__end">
      
        <div class="navbar-item navbar-persistent--container">
          

<button class="btn search-button-field search-button__button pst-js-only" title="Search" aria-label="Search" data-bs-placement="bottom" data-bs-toggle="tooltip">
 <i class="fa-solid fa-magnifying-glass"></i>
 <span class="search-button__default-text">Search</span>
 <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd class="kbd-shortcut__modifier">K</kbd></span>
</button>
        </div>
      
      
        <div class="navbar-item">

<button class="btn btn-sm nav-link pst-navbar-icon theme-switch-button pst-js-only" aria-label="Color mode" data-bs-title="Color mode"  data-bs-placement="bottom" data-bs-toggle="tooltip">
  <i class="theme-switch fa-solid fa-sun                fa-lg" data-mode="light" title="Light"></i>
  <i class="theme-switch fa-solid fa-moon               fa-lg" data-mode="dark"  title="Dark"></i>
  <i class="theme-switch fa-solid fa-circle-half-stroke fa-lg" data-mode="auto"  title="System Settings"></i>
</button></div>
      
        <div class="navbar-item"><ul class="navbar-icon-links"
    aria-label="Icon Links">
        <li class="nav-item">
          
          
          
          
          
          
          
          
          <a href="https://github.com/nbara/python-meegkit" title="GitHub" class="nav-link pst-navbar-icon" rel="noopener" target="_blank" data-bs-toggle="tooltip" data-bs-placement="bottom"><i class="fa-brands fa-github fa-lg" aria-hidden="true"></i>
            <span class="sr-only">GitHub</span></a>
        </li>
        <li class="nav-item">
          
          
          
          
          
          
          
          
          <a href="https://twitter.com/lebababa" title="Twitter" class="nav-link pst-navbar-icon" rel="noopener" target="_blank" data-bs-toggle="tooltip" data-bs-placement="bottom"><i class="fa-brands fa-twitter fa-lg" aria-hidden="true"></i>
            <span class="sr-only">Twitter</span></a>
        </li>
</ul></div>
      
    </div>
    
  </div>
  
  
    <div class="navbar-persistent--mobile">

<button class="btn search-button-field search-button__button pst-js-only" title="Search" aria-label="Search" data-bs-placement="bottom" data-bs-toggle="tooltip">
 <i class="fa-solid fa-magnifying-glass"></i>
 <span class="search-button__default-text">Search</span>
 <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd class="kbd-shortcut__modifier">K</kbd></span>
</button>
    </div>
  

  
    <button class="pst-navbar-icon sidebar-toggle secondary-toggle" aria-label="On this page">
      <span class="fa-solid fa-outdent"></span>
    </button>
  
</div>

    </header>
  

  <div class="bd-container">
    <div class="bd-container__inner bd-page-width">
      
      
      
        
      
      <dialog id="pst-primary-sidebar-modal"></dialog>
      <div id="pst-primary-sidebar" class="bd-sidebar-primary bd-sidebar hide-on-wide">
        

  
  <div class="sidebar-header-items sidebar-primary__section">
    
    
      <div class="sidebar-header-items__center">
        
          
          
            <div class="navbar-item">
<nav>
  <ul class="bd-navbar-elements navbar-nav">
    
<li class="nav-item ">
  <a class="nav-link nav-internal" href="../auto_examples/index.html">
    Examples gallery
  </a>
</li>


<li class="nav-item ">
  <a class="nav-link nav-external" href="https://github.com/nbara/python-meegkit">
    GitHub
  </a>
</li>

  </ul>
</nav></div>
          
        
      </div>
    
    
    
      <div class="sidebar-header-items__end">
        
          <div class="navbar-item">

<button class="btn btn-sm nav-link pst-navbar-icon theme-switch-button pst-js-only" aria-label="Color mode" data-bs-title="Color mode"  data-bs-placement="bottom" data-bs-toggle="tooltip">
  <i class="theme-switch fa-solid fa-sun                fa-lg" data-mode="light" title="Light"></i>
  <i class="theme-switch fa-solid fa-moon               fa-lg" data-mode="dark"  title="Dark"></i>
  <i class="theme-switch fa-solid fa-circle-half-stroke fa-lg" data-mode="auto"  title="System Settings"></i>
</button></div>
        
          <div class="navbar-item"><ul class="navbar-icon-links"
    aria-label="Icon Links">
        <li class="nav-item">
          
          
          
          
          
          
          
          
          <a href="https://github.com/nbara/python-meegkit" title="GitHub" class="nav-link pst-navbar-icon" rel="noopener" target="_blank" data-bs-toggle="tooltip" data-bs-placement="bottom"><i class="fa-brands fa-github fa-lg" aria-hidden="true"></i>
            <span class="sr-only">GitHub</span></a>
        </li>
        <li class="nav-item">
          
          
          
          
          
          
          
          
          <a href="https://twitter.com/lebababa" title="Twitter" class="nav-link pst-navbar-icon" rel="noopener" target="_blank" data-bs-toggle="tooltip" data-bs-placement="bottom"><i class="fa-brands fa-twitter fa-lg" aria-hidden="true"></i>
            <span class="sr-only">Twitter</span></a>
        </li>
</ul></div>
        
      </div>
    
  </div>
  
  
  <div class="sidebar-primary-items__end sidebar-primary__section">
      <div class="sidebar-primary-item">
<div id="ethical-ad-placement"
      class="flat"
      data-ea-publisher="readthedocs"
      data-ea-type="readthedocs-sidebar"
      data-ea-manual="true">
</div></div>
  </div>


      </div>
      
      <main id="main-content" class="bd-main" role="main">
        
        
          <div class="bd-content">
            <div class="bd-article-container">
              
              <div class="bd-header-article d-print-none">
<div class="header-article-items header-article__inner">
  
    <div class="header-article-items__start">
      
        <div class="header-article-item">

<nav aria-label="Breadcrumb" class="d-print-none">
  <ul class="bd-breadcrumbs">
    
    <li class="breadcrumb-item breadcrumb-home">
      <a href="../index.html" class="nav-link" aria-label="Home">
        <i class="fa-solid fa-home"></i>
      </a>
    </li>
    <li class="breadcrumb-item active" aria-current="page"><span class="ellipsis">meegkit.utils</span></li>
  </ul>
</nav>
</div>
      
    </div>
  
  
</div>
</div>
              
              
              
                
<div id="searchbox"></div>
                <article class="bd-article">
                  
  <section id="module-meegkit.utils">
<span id="meegkit-utils"></span><h1>meegkit.utils<a class="headerlink" href="#module-meegkit.utils" title="Link to this heading">#</a></h1>
<p>Utility functions.</p>
<div class="pst-scrollable-table-container"><table class="autosummary longtable table autosummary">
<tbody>
<tr class="row-odd"><td><p><a class="reference internal" href="#module-meegkit.utils.auditory" title="meegkit.utils.auditory"><code class="xref py py-obj docutils literal notranslate"><span class="pre">auditory</span></code></a></p></td>
<td><p>Tools for working with auditory signals.</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#module-meegkit.utils.buffer" title="meegkit.utils.buffer"><code class="xref py py-obj docutils literal notranslate"><span class="pre">buffer</span></code></a></p></td>
<td><p>Buffer class for real-time processing.</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#module-meegkit.utils.coherence" title="meegkit.utils.coherence"><code class="xref py py-obj docutils literal notranslate"><span class="pre">coherence</span></code></a></p></td>
<td><p>Signal coherence tools.</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#module-meegkit.utils.covariances" title="meegkit.utils.covariances"><code class="xref py py-obj docutils literal notranslate"><span class="pre">covariances</span></code></a></p></td>
<td><p>Covariance calculation.</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#module-meegkit.utils.denoise" title="meegkit.utils.denoise"><code class="xref py py-obj docutils literal notranslate"><span class="pre">denoise</span></code></a></p></td>
<td><p>Denoising utilities.</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#module-meegkit.utils.matrix" title="meegkit.utils.matrix"><code class="xref py py-obj docutils literal notranslate"><span class="pre">matrix</span></code></a></p></td>
<td><p>Matrix operation utility functions.</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#module-meegkit.utils.sig" title="meegkit.utils.sig"><code class="xref py py-obj docutils literal notranslate"><span class="pre">sig</span></code></a></p></td>
<td><p>Audio and signal processing tools.</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#module-meegkit.utils.stats" title="meegkit.utils.stats"><code class="xref py py-obj docutils literal notranslate"><span class="pre">stats</span></code></a></p></td>
<td><p>Statistics utilities.</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#module-meegkit.utils.trca" title="meegkit.utils.trca"><code class="xref py py-obj docutils literal notranslate"><span class="pre">trca</span></code></a></p></td>
<td><p>TRCA utils.</p></td>
</tr>
</tbody>
</table>
</div>
<div class="line-block">
<div class="line"><br /></div>
</div>
<hr class="docutils" />
<section id="module-meegkit.utils.auditory">
<span id="auditory"></span><h2>Auditory<a class="headerlink" href="#module-meegkit.utils.auditory" title="Link to this heading">#</a></h2>
<p>Tools for working with auditory signals.</p>
<div class="pst-scrollable-table-container"><table class="autosummary longtable table autosummary">
<tbody>
</tbody>
</table>
</div>
<dl class="py class">
<dt class="sig sig-object py" id="meegkit.utils.auditory.AuditoryFilterbank">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">meegkit.utils.auditory.</span></span><span class="sig-name descname"><span class="pre">AuditoryFilterbank</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">sfreq</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">b</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1.019</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">order</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">q</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">9.26449</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">min_bw</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">24.7</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#meegkit.utils.auditory.AuditoryFilterbank" title="Link to this definition">#</a></dt>
<dd><p>Bases: <a class="reference internal" href="#meegkit.utils.auditory.GammatoneFilterbank" title="meegkit.utils.auditory.GammatoneFilterbank"><code class="xref py py-class docutils literal notranslate"><span class="pre">GammatoneFilterbank</span></code></a></p>
<p>Special case of Gammatone filterbank with preset center frequencies.</p>
<dl class="py method">
<dt class="sig sig-object py" id="meegkit.utils.auditory.AuditoryFilterbank.__init__">
<span class="sig-name descname"><span class="pre">__init__</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">sfreq</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">b</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1.019</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">order</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">q</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">9.26449</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">min_bw</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">24.7</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#meegkit.utils.auditory.AuditoryFilterbank.__init__" title="Link to this definition">#</a></dt>
<dd></dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="meegkit.utils.auditory.GammatoneFilterbank">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">meegkit.utils.auditory.</span></span><span class="sig-name descname"><span class="pre">GammatoneFilterbank</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">sfreq</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">cf</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">b</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1.019</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">order</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">q</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">9.26449</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">min_bw</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">24.7</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#meegkit.utils.auditory.GammatoneFilterbank" title="Link to this definition">#</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">object</span></code></p>
<p>Gammatone Filterbank.</p>
<p>This class computes the filter coefficients for a bank of Gammatone
filters. These filters were defined by Patterson and Holdworth for
simulating the cochlea, and originally implemented in <a class="reference internal" href="#re1f0d87dfb88-1" id="id1">[1]</a>.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>sfreq</strong> (<em>float</em>) – Sampling frequency of the signals to filter.</p></li>
<li><p><strong>cf</strong> (<em>array_like</em>) – Center frequencies of the filterbank.</p></li>
<li><p><strong>b</strong> (<em>float</em>) – beta of the gammatone filters (default=1.019).</p></li>
<li><p><strong>order</strong> (<em>int</em>) – Order (default=1).</p></li>
<li><p><strong>q</strong> (<em>float</em>) – Q-value of the ERB (default=9.26449).</p></li>
<li><p><strong>min_bw</strong> (<em>float</em>) – Minimum bandwidth of an ERB.</p></li>
</ul>
</dd>
</dl>
<p class="rubric">Notes</p>
<p>The python was adapted from Alexandre Chabot-Leclerc’s pambox, and Jason
Heeris’ gammatone toolbox:
<a class="github reference external" href="https://github.com/achabotl/pambox">achabotl/pambox</a>
<a class="github reference external" href="https://github.com/detly/gammatone">detly/gammatone</a></p>
<p class="rubric">References</p>
<div role="list" class="citation-list">
<div class="citation" id="re1f0d87dfb88-1" role="doc-biblioentry">
<span class="label"><span class="fn-bracket">[</span><a role="doc-backlink" href="#id1">1</a><span class="fn-bracket">]</span></span>
<p>Slaney, M. (1993). An efficient implementation of the
Patterson-Holdsworth auditory filter bank. Apple Computer, Perception
Group, Tech. Rep, 35(8).</p>
</div>
</div>
<dl class="py method">
<dt class="sig sig-object py" id="meegkit.utils.auditory.GammatoneFilterbank.__init__">
<span class="sig-name descname"><span class="pre">__init__</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">sfreq</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">cf</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">b</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1.019</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">order</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">q</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">9.26449</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">min_bw</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">24.7</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#meegkit.utils.auditory.GammatoneFilterbank.__init__" title="Link to this definition">#</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="meegkit.utils.auditory.GammatoneFilterbank.filter">
<span class="sig-name descname"><span class="pre">filter</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">X</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#meegkit.utils.auditory.GammatoneFilterbank.filter" title="Link to this definition">#</a></dt>
<dd><p>Filter X along its last dimension.</p>
<p>Process an input waveform with a gammatone filter bank. This function
takes a single sound vector, and returns an array of filter outputs,
one channel per row.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>X</strong> (<em>ndarray</em><em>, </em><em>shape=</em><em>(</em><em>n_chans</em><em>, </em><em>n_times</em><em>)</em>) – Signal to filter.</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Filtered signals with shape <code class="docutils literal notranslate"><span class="pre">(M,</span> <span class="pre">N)</span></code>, where <code class="docutils literal notranslate"><span class="pre">M</span></code> is the number
of channels, and <code class="docutils literal notranslate"><span class="pre">N</span></code> is the input signal’s number of samples.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>ndarray</p>
</dd>
</dl>
</dd></dl>

</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="meegkit.utils.auditory.erb2hz">
<span class="sig-prename descclassname"><span class="pre">meegkit.utils.auditory.</span></span><span class="sig-name descname"><span class="pre">erb2hz</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">erb</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#meegkit.utils.auditory.erb2hz" title="Link to this definition">#</a></dt>
<dd><p>Convert ERB-rate values to the corresponding frequencies in Hz.</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="meegkit.utils.auditory.erb_bandwidth">
<span class="sig-prename descclassname"><span class="pre">meegkit.utils.auditory.</span></span><span class="sig-name descname"><span class="pre">erb_bandwidth</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">fc</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#meegkit.utils.auditory.erb_bandwidth" title="Link to this definition">#</a></dt>
<dd><p>Bandwidth of an Equivalent Rectangular Bandwidth (ERB).</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>fc</strong> (<em>ndarray</em>) – Center frequency, or center frequencies, of the filter.</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Equivalent rectangular bandwidth of the filter(s).</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>ndarray or float</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="meegkit.utils.auditory.erbspace">
<span class="sig-prename descclassname"><span class="pre">meegkit.utils.auditory.</span></span><span class="sig-name descname"><span class="pre">erbspace</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">flow</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">fhigh</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">n</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#meegkit.utils.auditory.erbspace" title="Link to this definition">#</a></dt>
<dd><p>Generate n equidistantly spaced points on ERB scale.</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="meegkit.utils.auditory.hz2erb">
<span class="sig-prename descclassname"><span class="pre">meegkit.utils.auditory.</span></span><span class="sig-name descname"><span class="pre">hz2erb</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">f</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#meegkit.utils.auditory.hz2erb" title="Link to this definition">#</a></dt>
<dd><p>Convert frequencies to the corresponding ERB-rates.</p>
<p class="rubric">Notes</p>
<p>There is a round-off error in the Glasberg &amp; Moore paper, as 1000 / (24.7 *
4.37) * log(10) = 21.332 and not 21.4 as is stated.</p>
</dd></dl>

<div class="line-block">
<div class="line"><br /></div>
</div>
</section>
<hr class="docutils" />
<section id="module-meegkit.utils.buffer">
<span id="buffer"></span><h2>Buffer<a class="headerlink" href="#module-meegkit.utils.buffer" title="Link to this heading">#</a></h2>
<p>Buffer class for real-time processing.</p>
<div class="pst-scrollable-table-container"><table class="autosummary longtable table autosummary">
<tbody>
</tbody>
</table>
</div>
<dl class="py class">
<dt class="sig sig-object py" id="meegkit.utils.buffer.Buffer">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">meegkit.utils.buffer.</span></span><span class="sig-name descname"><span class="pre">Buffer</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">size</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">n_channels</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#meegkit.utils.buffer.Buffer" title="Link to this definition">#</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">object</span></code></p>
<p>Circular buffer for real-time processing.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>size</strong> (<em>int</em>) – The number of samples of the buffer.</p></li>
<li><p><strong>n_channels</strong> (<em>int</em>) – The number of channels of the buffer.</p></li>
</ul>
</dd>
</dl>
<dl class="py attribute">
<dt class="sig sig-object py" id="meegkit.utils.buffer.Buffer.size">
<span class="sig-name descname"><span class="pre">size</span></span><a class="headerlink" href="#meegkit.utils.buffer.Buffer.size" title="Link to this definition">#</a></dt>
<dd><p>The number of samples of the buffer.</p>
<dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p>int</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="meegkit.utils.buffer.Buffer.n_channels">
<span class="sig-name descname"><span class="pre">n_channels</span></span><a class="headerlink" href="#meegkit.utils.buffer.Buffer.n_channels" title="Link to this definition">#</a></dt>
<dd><p>The number of channels of the buffer.</p>
<dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p>int</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="meegkit.utils.buffer.Buffer.counter">
<span class="sig-name descname"><span class="pre">counter</span></span><a class="headerlink" href="#meegkit.utils.buffer.Buffer.counter" title="Link to this definition">#</a></dt>
<dd><p>The number of samples in the buffer.</p>
<dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p>int</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="meegkit.utils.buffer.Buffer._data">
<span class="sig-name descname"><span class="pre">_data</span></span><a class="headerlink" href="#meegkit.utils.buffer.Buffer._data" title="Link to this definition">#</a></dt>
<dd><p>Data buffer.</p>
<dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p>ndarray, shape (size, n_channels)</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="meegkit.utils.buffer.Buffer.__init__">
<span class="sig-name descname"><span class="pre">__init__</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">size</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">n_channels</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#meegkit.utils.buffer.Buffer.__init__" title="Link to this definition">#</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="meegkit.utils.buffer.Buffer.get_new_samples">
<span class="sig-name descname"><span class="pre">get_new_samples</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">n_samples</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#meegkit.utils.buffer.Buffer.get_new_samples" title="Link to this definition">#</a></dt>
<dd><p>Consume n_samples.</p>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="meegkit.utils.buffer.Buffer.head">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">head</span></span><a class="headerlink" href="#meegkit.utils.buffer.Buffer.head" title="Link to this definition">#</a></dt>
<dd><p>Get the index of the head.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="meegkit.utils.buffer.Buffer.push">
<span class="sig-name descname"><span class="pre">push</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">X</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#meegkit.utils.buffer.Buffer.push" title="Link to this definition">#</a></dt>
<dd><p>Update the buffer with new data.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>X</strong> (<em>ndarray</em><em>, </em><em>shape</em><em> (</em><em>n_samples</em><em>, </em><em>n_channels</em><em>)</em>) – The input signal to be transformed.</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="meegkit.utils.buffer.Buffer.reset">
<span class="sig-name descname"><span class="pre">reset</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#meegkit.utils.buffer.Buffer.reset" title="Link to this definition">#</a></dt>
<dd><p>Reset the buffer.</p>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="meegkit.utils.buffer.Buffer.tail">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">tail</span></span><a class="headerlink" href="#meegkit.utils.buffer.Buffer.tail" title="Link to this definition">#</a></dt>
<dd><p>Get the index of the tail.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="meegkit.utils.buffer.Buffer.view">
<span class="sig-name descname"><span class="pre">view</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">n_samples</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#meegkit.utils.buffer.Buffer.view" title="Link to this definition">#</a></dt>
<dd><p>View the last n_samples, without consuming them.</p>
</dd></dl>

</dd></dl>

<div class="line-block">
<div class="line"><br /></div>
</div>
</section>
<hr class="docutils" />
<section id="module-meegkit.utils.coherence">
<span id="coherence"></span><h2>Coherence<a class="headerlink" href="#module-meegkit.utils.coherence" title="Link to this heading">#</a></h2>
<p>Signal coherence tools.</p>
<p>Compute 2D, 1D, and 0D bicoherence, polycoherence, bispectrum, and polyspectrum.</p>
<p>Bicoherence is a measure of the degree of phase coupling between different
frequency components in a signal. It’s essentially a normalized form of the
bispectrum, which itself is a Fourier transform of the third-order cumulant of
a time series:</p>
<ul class="simple">
<li><p>2D bicoherence is the most common form, where one looks at a
two-dimensional representation of the phase coupling between different
frequencies. It’s a function of two frequency variables.</p></li>
<li><p>1D bicoherence would imply a slice or a specific condition in the 2D
bicoherence, reducing it to a function of a single frequency variable. It
simplifies the analysis by looking at the relationship between a particular
frequency and its harmonics or other relationships</p></li>
<li><p>0D bicoherence would imply a single value representing some average or
overall measure of phase coupling in the signal. It’s a highly condensed
summary, which might represent the average bicoherence over all frequency
pairs, for instance.</p></li>
</ul>
<div class="pst-scrollable-table-container"><table class="autosummary longtable table autosummary">
<tbody>
</tbody>
</table>
</div>
<dl class="py function">
<dt class="sig sig-object py" id="meegkit.utils.coherence.compute_spectrogram">
<span class="sig-prename descclassname"><span class="pre">meegkit.utils.coherence.</span></span><span class="sig-name descname"><span class="pre">compute_spectrogram</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">X</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">sfreq</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#meegkit.utils.coherence.compute_spectrogram" title="Link to this definition">#</a></dt>
<dd><p>Compute the complex spectrogram of X.</p>
<p>Simple wrapper around scipy.signal.spectrogram.</p>
<dl class="field-list simple">
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p><ul class="simple">
<li><p><strong>f</strong> (<em>ndarray, shape=(n_freqs,)</em>) – Positive frequencies.</p></li>
<li><p><strong>t</strong> (<em>ndarray, shape=(n_timesteps,)</em>) – Time axis.</p></li>
<li><p><strong>S</strong> (<em>ndarray, shape=(n_chans, n_timesteps, n_freqs)</em>) – Complex spectrogram (one-sided).</p></li>
</ul>
</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="meegkit.utils.coherence.cross_coherence">
<span class="sig-prename descclassname"><span class="pre">meegkit.utils.coherence.</span></span><span class="sig-name descname"><span class="pre">cross_coherence</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">x1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">x2</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">sfreq</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">norm</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">2</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#meegkit.utils.coherence.cross_coherence" title="Link to this definition">#</a></dt>
<dd><p>Compute the bispectral cross-coherence between two signals of same length.</p>
<p>Code adapted from <a class="reference internal" href="#r184c36f39131-2" id="id2">[2]</a>.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>x1</strong> (<em>array-like</em><em>, </em><em>shape=</em><em>(</em><em>[</em><em>n_channels</em><em>, </em><em>]</em><em>n_samples</em><em>)</em>) – First signal.</p></li>
<li><p><strong>x2</strong> (<em>array-like</em><em>, </em><em>shape=</em><em>(</em><em>[</em><em>n_channels</em><em>, </em><em>]</em><em>n_samples</em><em>)</em>) – Second signal.</p></li>
<li><p><strong>sfreq</strong> (<em>float</em>) – Sampling sfreq.</p></li>
<li><p><strong>norm</strong> (<em>int</em><em> | </em><em>None</em>) – Norm (default=2). If None, return bispectrum.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><ul class="simple">
<li><p><strong>f1</strong> (<em>array-like</em>) – Frequency axis.</p></li>
<li><p><strong>B</strong> (<em>array-like</em>) – Bicoherence between s1 and s2.</p></li>
</ul>
</p>
</dd>
</dl>
<p class="rubric">References</p>
<div role="list" class="citation-list">
<div class="citation" id="r184c36f39131-1" role="doc-biblioentry">
<span class="label"><span class="fn-bracket">[</span>1<span class="fn-bracket">]</span></span>
<p><a class="reference external" href="http://wiki.fusenet.eu/wiki/Bicoherence">http://wiki.fusenet.eu/wiki/Bicoherence</a></p>
</div>
<div class="citation" id="r184c36f39131-2" role="doc-biblioentry">
<span class="label"><span class="fn-bracket">[</span><a role="doc-backlink" href="#id2">2</a><span class="fn-bracket">]</span></span>
<p><a class="reference external" href="https://stackoverflow.com/a/36725871">https://stackoverflow.com/a/36725871</a></p>
</div>
</div>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="meegkit.utils.coherence.norm_spectrum">
<span class="sig-prename descclassname"><span class="pre">meegkit.utils.coherence.</span></span><span class="sig-name descname"><span class="pre">norm_spectrum</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">spec</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">P1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">P2</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">P12</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">time_axis</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">-2</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#meegkit.utils.coherence.norm_spectrum" title="Link to this definition">#</a></dt>
<dd><p>Compute bicoherence from bispectrum.</p>
<p>For formula see <a class="reference internal" href="#rb9240e744724-1" id="id3">[1]</a>.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>spec</strong> (<em>ndarray</em><em>, </em><em>shape=</em><em>(</em><em>n_chans</em><em>, </em><em>n_freqs</em><em>)</em>) – Polyspectrum.</p></li>
<li><p><strong>P1</strong> (<em>array-like</em><em>, </em><em>shape=</em><em>(</em><em>n_chans</em><em>, </em><em>n_times</em><em>, </em><em>n_freqs_f1</em><em>)</em>) – Spectrum evaluated at f1.</p></li>
<li><p><strong>P2</strong> (<em>array-like</em><em>, </em><em>shape=</em><em>(</em><em>n_chans</em><em>, </em><em>n_times</em><em>, </em><em>n_freqs_f2</em><em>)</em>) – Spectrum evaluated at f2.</p></li>
<li><p><strong>P12</strong> (<em>array-like</em><em>, </em><em>shape=</em><em>(</em><em>n_chans</em><em>, </em><em>n_times</em><em>, </em><em>n_freqs</em><em>)</em>) – Spectrum evaluated at f1 + f2.</p></li>
<li><p><strong>time_axis</strong> (<em>int</em>) – Time axis.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><strong>coh</strong> – Polycoherence.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>ndarray, shape=(n_chans,)</p>
</dd>
</dl>
<p class="rubric">References</p>
<div role="list" class="citation-list">
<div class="citation" id="rb9240e744724-1" role="doc-biblioentry">
<span class="label"><span class="fn-bracket">[</span><a role="doc-backlink" href="#id3">1</a><span class="fn-bracket">]</span></span>
<p><a class="reference external" href="https://en.wikipedia.org/wiki/Bicoherence">https://en.wikipedia.org/wiki/Bicoherence</a></p>
</div>
</div>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="meegkit.utils.coherence.plot_polycoherence">
<span class="sig-prename descclassname"><span class="pre">meegkit.utils.coherence.</span></span><span class="sig-name descname"><span class="pre">plot_polycoherence</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">freq1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">freq2</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">bicoh</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ax</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#meegkit.utils.coherence.plot_polycoherence" title="Link to this definition">#</a></dt>
<dd><p>Plot polycoherence.</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="meegkit.utils.coherence.plot_polycoherence_1d">
<span class="sig-prename descclassname"><span class="pre">meegkit.utils.coherence.</span></span><span class="sig-name descname"><span class="pre">plot_polycoherence_1d</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">freq</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">coh</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#meegkit.utils.coherence.plot_polycoherence_1d" title="Link to this definition">#</a></dt>
<dd><p>Plot polycoherence for fixed frequencies.</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="meegkit.utils.coherence.plot_signal">
<span class="sig-prename descclassname"><span class="pre">meegkit.utils.coherence.</span></span><span class="sig-name descname"><span class="pre">plot_signal</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">t</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">signal</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ax</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#meegkit.utils.coherence.plot_signal" title="Link to this definition">#</a></dt>
<dd><p>Plot signal and spectrum.</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="meegkit.utils.coherence.polycoherence_0d">
<span class="sig-prename descclassname"><span class="pre">meegkit.utils.coherence.</span></span><span class="sig-name descname"><span class="pre">polycoherence_0d</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">X</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">sfreq</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">freqs</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">norm</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">2</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">synthetic</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#meegkit.utils.coherence.polycoherence_0d" title="Link to this definition">#</a></dt>
<dd><p>Polycoherence between freqs and sum of freqs.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>X</strong> (<em>ndarray</em><em>, </em><em>shape=</em><em>(</em><em>n_channels</em><em>, </em><em>n_samples</em><em>)</em>) – Input data.</p></li>
<li><p><strong>sfreq</strong> (<em>float</em>) – Sampling rate.</p></li>
<li><p><strong>freqs</strong> (<em>list</em><em>[</em><em>float</em><em>]</em>) – Fixed frequencies.</p></li>
<li><p><strong>norm</strong> (<em>int</em><em> | </em><em>None</em>) – Norm (default=2).</p></li>
<li><p><strong>synthetic</strong> (<em>tuple</em><em>(</em><em>float</em><em>, </em><em>float</em><em>, </em><em>float</em><em>)</em>) – Used for synthetic signal for some frequencies (freq, amplitude,
phase), freq must coincide with the first fixed frequency.</p></li>
<li><p><strong>**kwargs</strong> (<em>dict</em>) – Additional parameters passed to scipy.signal.spectrogram. Important
parameters are nperseg, noverlap, nfft.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><strong>B</strong> – Polycoherence</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>ndarray, shape=(n_channels,)</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="meegkit.utils.coherence.polycoherence_1d">
<span class="sig-prename descclassname"><span class="pre">meegkit.utils.coherence.</span></span><span class="sig-name descname"><span class="pre">polycoherence_1d</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">X</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">sfreq</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">f2</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">norm</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">2</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">synthetic</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#meegkit.utils.coherence.polycoherence_1d" title="Link to this definition">#</a></dt>
<dd><p>1D polycoherence as a function of f1 and at least one fixed frequency f2.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>X</strong> (<em>ndarray</em>) – Input data.</p></li>
<li><p><strong>sfreq</strong> (<em>float</em>) – Sampling rate</p></li>
<li><p><strong>f2</strong> (<em>list</em><em>[</em><em>float</em><em>]</em>) – Fixed frequencies.</p></li>
<li><p><strong>norm</strong> (<em>int</em><em> | </em><em>None</em>) – Norm (default=2).</p></li>
<li><p><strong>synthetic</strong> (<em>tuple</em><em>(</em><em>float</em><em>, </em><em>float</em><em>, </em><em>float</em><em>)</em>) – Used for synthetic signal for some frequencies (freq, amplitude,
phase), freq must coincide with the first fixed frequency.</p></li>
<li><p><strong>**kwargs</strong> – Additional parameters passed to scipy.signal.spectrogram. Important
parameters are <cite>nperseg</cite>, <cite>noverlap</cite>, <cite>nfft</cite>.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><ul class="simple">
<li><p><strong>freq</strong> (<em>ndarray, shape=(n_freqs_f1,)</em>) – Frequencies</p></li>
<li><p><strong>B</strong> (<em>ndarray, shape=(n_channels, n_freqs_f1)</em>) – 1D polycoherence.</p></li>
</ul>
</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="meegkit.utils.coherence.polycoherence_1d_sum">
<span class="sig-prename descclassname"><span class="pre">meegkit.utils.coherence.</span></span><span class="sig-name descname"><span class="pre">polycoherence_1d_sum</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">X</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">sfreq</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">fsum</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">*</span></span><span class="n"><span class="pre">ofreqs</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">norm</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">2</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">synthetic</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#meegkit.utils.coherence.polycoherence_1d_sum" title="Link to this definition">#</a></dt>
<dd><p>1D polycoherence with fixed frequency sum fsum as a function of f1.</p>
<p>Returns polycoherence for frequencies ranging from 0 up to fsum.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>X</strong> (<em>ndarray</em>) – Input data.</p></li>
<li><p><strong>sfreq</strong> (<em>float</em>) – Sampling rate.</p></li>
<li><p><strong>fsum</strong> (<em>float</em>) – Fixed frequency sum.</p></li>
<li><p><strong>ofreqs</strong> (<em>list</em><em>[</em><em>float</em><em>]</em>) – Fixed frequencies.</p></li>
<li><p><strong>norm</strong> (<em>int</em><em> or </em><em>None</em>) – If 2 - return polycoherence, n0 = n1 = n2 = 2 (default)</p></li>
<li><p><strong>synthetic</strong> (<em>tuple</em><em>(</em><em>float</em><em>, </em><em>float</em><em>, </em><em>float</em><em>) </em><em>| </em><em>None</em>) – Used for synthetic signal for some frequencies (freq, amplitude,
phase), freq must coincide with the first fixed frequency.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><ul class="simple">
<li><p><strong>freq</strong> (<em>ndarray, shape=(n_freqs,)</em>) – Frequencies.</p></li>
<li><p><strong>B</strong> (<em>ndarray, shape=(n_channels, n_freqs)</em>) – Polycoherence for f1+f2=fsum.</p></li>
</ul>
</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="meegkit.utils.coherence.polycoherence_2d">
<span class="sig-prename descclassname"><span class="pre">meegkit.utils.coherence.</span></span><span class="sig-name descname"><span class="pre">polycoherence_2d</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">X</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">sfreq</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ofreqs</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">norm</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">2</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">flim1</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">flim2</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">synthetic</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#meegkit.utils.coherence.polycoherence_2d" title="Link to this definition">#</a></dt>
<dd><p>2D polycoherence between freqs and their sum as a function of f1 and f2.</p>
<p>2D bicoherence is the most common form, where one looks at a
two-dimensional representation of the phase coupling between different
frequencies. It is a function of two frequency variables.</p>
<p>2D polycoherence as a function of f1 and f2, ofreqs are additional fixed
frequencies.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>X</strong> (<em>ndarray</em>) – Input data.</p></li>
<li><p><strong>sfreq</strong> (<em>float</em>) – Sampling rate.</p></li>
<li><p><strong>ofreqs</strong> (<em>list</em><em>[</em><em>float</em><em>]</em>) – Fixed frequencies.</p></li>
<li><p><strong>norm</strong> (<em>int</em><em> or </em><em>None</em>) – If 2 - return polycoherence (default), else return polyspectrum.</p></li>
<li><p><strong>flim1</strong> (<em>tuple</em><em> | </em><em>None</em>) – Frequency limits for f1. If None, it is set to (0, nyquist / 2)</p></li>
<li><p><strong>flim2</strong> (<em>tuple</em><em> | </em><em>None</em>) – Frequency limits for f2.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><ul class="simple">
<li><p><strong>freq1</strong> (<em>ndarray, shape=(n_freqs_f1,)</em>) – Frequencies for f1.</p></li>
<li><p><strong>freq2</strong> (<em>ndarray, shape=(n_freqs_f2,)</em>) – Frequencies for f2.</p></li>
<li><p><strong>B</strong> (<em>ndarray, shape=([n_chans, ]n_freqs_f1, n_freqs_f2)</em>) – Polycoherence.</p></li>
</ul>
</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="meegkit.utils.coherence.synthetic_signal">
<span class="sig-prename descclassname"><span class="pre">meegkit.utils.coherence.</span></span><span class="sig-name descname"><span class="pre">synthetic_signal</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">t</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">synthetic</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#meegkit.utils.coherence.synthetic_signal" title="Link to this definition">#</a></dt>
<dd><p>Create a synthetic complex signal spectrum.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>t</strong> (<em>array-like</em>) – Time.</p></li>
<li><p><strong>synthetic</strong> (<em>list</em><em>[</em><em>tuple</em><em>(</em><em>float</em><em>, </em><em>float</em><em>, </em><em>float</em><em>)</em><em>]</em>) – List of tuples with (freq, amplitude, phase).</p></li>
</ul>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p>Complex signal.</p>
</dd>
</dl>
</dd></dl>

<div class="line-block">
<div class="line"><br /></div>
</div>
</section>
<hr class="docutils" />
<section id="module-meegkit.utils.covariances">
<span id="covariances"></span><h2>Covariances<a class="headerlink" href="#module-meegkit.utils.covariances" title="Link to this heading">#</a></h2>
<p>Covariance calculation.</p>
<div class="pst-scrollable-table-container"><table class="autosummary longtable table autosummary">
<tbody>
</tbody>
</table>
</div>
<dl class="py function">
<dt class="sig sig-object py" id="meegkit.utils.covariances.block_covariance">
<span class="sig-prename descclassname"><span class="pre">meegkit.utils.covariances.</span></span><span class="sig-name descname"><span class="pre">block_covariance</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">data</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">window</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">128</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">overlap</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.5</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">padding</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">estimator</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'cov'</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#meegkit.utils.covariances.block_covariance" title="Link to this definition">#</a></dt>
<dd><p>Compute blockwise covariance.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>data</strong> (<em>array</em><em>, </em><em>shape=</em><em>(</em><em>n_chans</em><em>, </em><em>n_samples</em><em>)</em>) – Input data (must be 2D)</p></li>
<li><p><strong>window</strong> (<em>int</em>) – Window size.</p></li>
<li><p><strong>overlap</strong> (<em>float</em>) – Overlap between successive windows.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><strong>cov</strong> – Block covariance.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>array, shape=(n_blocks, n_chans, n_chans)</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="meegkit.utils.covariances.convmtx">
<span class="sig-prename descclassname"><span class="pre">meegkit.utils.covariances.</span></span><span class="sig-name descname"><span class="pre">convmtx</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">V</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">n</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#meegkit.utils.covariances.convmtx" title="Link to this definition">#</a></dt>
<dd><p>Generate a convolution matrix.</p>
<p>CONVMTX(V,N) returns the convolution matrix for vector V. If V is a column
vector and X is a column vector of length N, then CONVMTX(V,N)*X is the
same as CONV(V,X). If R is a row vector and X is a row vector of length N,
then X*CONVMTX(R,N) is the same as CONV(R,X).</p>
<p>Given a vector V of length N, an N+n-1 by n convolution matrix is
generated of the following form:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>    <span class="o">|</span>  <span class="n">V</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>  <span class="mi">0</span>      <span class="mi">0</span>     <span class="o">...</span>      <span class="mi">0</span>    <span class="o">|</span>
    <span class="o">|</span>  <span class="n">V</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span> <span class="n">V</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>    <span class="mi">0</span>     <span class="o">...</span>      <span class="mi">0</span>    <span class="o">|</span>
    <span class="o">|</span>  <span class="n">V</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span> <span class="n">V</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>   <span class="n">V</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>   <span class="o">...</span>      <span class="mi">0</span>    <span class="o">|</span>
<span class="n">X</span> <span class="o">=</span> <span class="o">|</span>   <span class="o">.</span>    <span class="o">.</span>      <span class="o">.</span>              <span class="o">.</span>    <span class="o">|</span>
    <span class="o">|</span>   <span class="o">.</span>    <span class="o">.</span>      <span class="o">.</span>              <span class="o">.</span>    <span class="o">|</span>
    <span class="o">|</span>   <span class="o">.</span>    <span class="o">.</span>      <span class="o">.</span>              <span class="o">.</span>    <span class="o">|</span>
    <span class="o">|</span>  <span class="n">V</span><span class="p">(</span><span class="n">N</span><span class="p">)</span> <span class="n">V</span><span class="p">(</span><span class="n">N</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span> <span class="n">V</span><span class="p">(</span><span class="n">N</span><span class="o">-</span><span class="mi">2</span><span class="p">)</span> <span class="o">...</span>  <span class="n">V</span><span class="p">(</span><span class="n">N</span><span class="o">-</span><span class="n">n</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span> <span class="o">|</span>
    <span class="o">|</span>   <span class="mi">0</span>   <span class="n">V</span><span class="p">(</span><span class="n">N</span><span class="p">)</span>   <span class="n">V</span><span class="p">(</span><span class="n">N</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span> <span class="o">...</span>  <span class="n">V</span><span class="p">(</span><span class="n">N</span><span class="o">-</span><span class="n">n</span><span class="o">+</span><span class="mi">2</span><span class="p">)</span> <span class="o">|</span>
    <span class="o">|</span>   <span class="o">.</span>    <span class="o">.</span>      <span class="o">.</span>              <span class="o">.</span>    <span class="o">|</span>
    <span class="o">|</span>   <span class="o">.</span>    <span class="o">.</span>      <span class="o">.</span>              <span class="o">.</span>    <span class="o">|</span>
    <span class="o">|</span>   <span class="mi">0</span>    <span class="mi">0</span>      <span class="mi">0</span>     <span class="o">...</span>    <span class="n">V</span><span class="p">(</span><span class="n">N</span><span class="p">)</span>   <span class="o">|</span>
</pre></div>
</div>
<p>That is, V is assumed to be causal, and zero-valued after N.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>V</strong> (<em>array</em><em>, </em><em>shape=</em><em>(</em><em>N</em><em>,</em><em>) </em><em>or</em><em>(</em><em>N</em><em>, </em><em>1</em><em>) or </em><em>(</em><em>1</em><em>, </em><em>N</em><em>)</em>) – Input vector.</p></li>
<li><p><strong>n</strong> (<em>int</em>)</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><strong>t</strong></p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>array, shape=(N * n - 1, n)</p>
</dd>
</dl>
<p class="rubric">Examples</p>
<p>Generate a simple convolution matrix:</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">h</span> <span class="o">=</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">1</span><span class="p">]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">convmtx</span><span class="p">(</span><span class="n">h</span><span class="p">,</span><span class="mi">7</span><span class="p">)</span>
<span class="go">np.array(</span>
<span class="go">    [[1. 2. 1. 0. 0. 0.]</span>
<span class="go">     [0. 1. 2. 1. 0. 0.]</span>
<span class="go">     [0. 0. 1. 2. 1. 0.]</span>
<span class="go">     [0. 0. 0. 1. 2. 1.]]</span>
<span class="go">)</span>
</pre></div>
</div>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="meegkit.utils.covariances.cov_lags">
<span class="sig-prename descclassname"><span class="pre">meegkit.utils.covariances.</span></span><span class="sig-name descname"><span class="pre">cov_lags</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">X</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">Y</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">shifts</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#meegkit.utils.covariances.cov_lags" title="Link to this definition">#</a></dt>
<dd><p>Empirical covariance of the joint array [X, Y] with lags.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>X</strong> (<em>array</em><em>, </em><em>shape=</em><em>(</em><em>n_times</em><em>, </em><em>n_chans_x</em><em>[</em><em>, </em><em>n_trials</em><em>]</em><em>)</em>) – Time shifted data.</p></li>
<li><p><strong>Y</strong> (<em>array</em><em>, </em><em>shape=</em><em>(</em><em>n_times</em><em>, </em><em>n_chans_y</em><em>[</em><em>, </em><em>n_trials</em><em>]</em><em>)</em>) – Reference data.</p></li>
<li><p><strong>shifts</strong> (<em>array</em><em>, </em><em>shape=</em><em>(</em><em>n_shifts</em><em>,</em><em>)</em>) – Positive lag means X is delayed relative to Y.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><ul class="simple">
<li><p><strong>C</strong> (<em>array, shape=(n_chans_x + n_chans_y, n_chans_x + n_chans_y, n_shifts)</em>) – Covariance matrix (3D if n_shifts &gt; 1).</p></li>
<li><p><strong>tw</strong> (<em>float</em>) – Total weight.</p></li>
<li><p><strong>m</strong> (<em>int</em>) – Number of columns in X.</p></li>
</ul>
</p>
</dd>
</dl>
<div class="admonition seealso">
<p class="admonition-title">See also</p>
<p><code class="xref py py-obj docutils literal notranslate"><span class="pre">relshift</span></code>, <a class="reference internal" href="#meegkit.utils.covariances.tscov" title="meegkit.utils.covariances.tscov"><code class="xref py py-obj docutils literal notranslate"><span class="pre">tscov</span></code></a>, <a class="reference internal" href="#meegkit.utils.covariances.tsxcov" title="meegkit.utils.covariances.tsxcov"><code class="xref py py-obj docutils literal notranslate"><span class="pre">tsxcov</span></code></a></p>
</div>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="meegkit.utils.covariances.nonlinear_eigenspace">
<span class="sig-prename descclassname"><span class="pre">meegkit.utils.covariances.</span></span><span class="sig-name descname"><span class="pre">nonlinear_eigenspace</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">L</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">k</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">alpha</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#meegkit.utils.covariances.nonlinear_eigenspace" title="Link to this definition">#</a></dt>
<dd><p>Nonlinear eigenvalue problem: total energy minimization.</p>
<p>This example is motivated in <a class="reference internal" href="#r82ca249c190f-1" id="id4">[1]</a> and was adapted from the manopt toolbox
in Matlab.</p>
<p>TODO : check this</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>L</strong> (<em>array</em><em>, </em><em>shape=</em><em>(</em><em>n_channels</em><em>, </em><em>n_channels</em><em>)</em>) – Discrete Laplacian operator: the covariance matrix.</p></li>
<li><p><strong>alpha</strong> (<em>float</em>) – Given constant for optimization problem.</p></li>
<li><p><strong>k</strong> (<em>int</em>) – Determines how many eigenvalues are returned.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><ul class="simple">
<li><p><strong>Xsol</strong> (<em>array, shape=(n_channels, n_channels)</em>) – Eigenvectors.</p></li>
<li><p><strong>S0</strong> (<em>array</em>) – Eigenvalues.</p></li>
</ul>
</p>
</dd>
</dl>
<p class="rubric">References</p>
<div role="list" class="citation-list">
<div class="citation" id="r82ca249c190f-1" role="doc-biblioentry">
<span class="label"><span class="fn-bracket">[</span><a role="doc-backlink" href="#id4">1</a><span class="fn-bracket">]</span></span>
<p>“A Riemannian Newton Algorithm for Nonlinear Eigenvalue Problems”,
Zhi Zhao, Zheng-Jian Bai, and Xiao-Qing Jin, SIAM Journal on Matrix
Analysis and Applications, 36(2), 752-774, 2015.</p>
</div>
</div>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="meegkit.utils.covariances.pca">
<span class="sig-prename descclassname"><span class="pre">meegkit.utils.covariances.</span></span><span class="sig-name descname"><span class="pre">pca</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">cov</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">max_comps</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">thresh</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#meegkit.utils.covariances.pca" title="Link to this definition">#</a></dt>
<dd><p>PCA from covariance.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>cov</strong> (<em>array</em><em>, </em><em>shape=</em><em>(</em><em>n_chans</em><em>, </em><em>n_chans</em><em>)</em>) – Covariance matrix.</p></li>
<li><p><strong>max_comps</strong> (<em>int</em><em> | </em><em>None</em>) – Maximum number of components to retain after decomposition. <code class="docutils literal notranslate"><span class="pre">None</span></code>
(the default) keeps all suprathreshold components (see <code class="docutils literal notranslate"><span class="pre">thresh</span></code>).</p></li>
<li><p><strong>thresh</strong> (<em>float</em>) – Discard components below this threshold.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><ul class="simple">
<li><p><strong>V</strong> (<em>array, shape=(max_comps, max_comps)</em>) – Eigenvectors (matrix of PCA components).</p></li>
<li><p><strong>d</strong> (<em>array, shape=(max_comps,)</em>) – PCA eigenvalues</p></li>
</ul>
</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="meegkit.utils.covariances.regcov">
<span class="sig-prename descclassname"><span class="pre">meegkit.utils.covariances.</span></span><span class="sig-name descname"><span class="pre">regcov</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">Cxy</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">Cyy</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">keep</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">threshold</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#meegkit.utils.covariances.regcov" title="Link to this definition">#</a></dt>
<dd><p>Compute regression matrix from cross covariance.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>Cxy</strong> (<em>array</em>) – Cross-covariance matrix between data and regressor.</p></li>
<li><p><strong>Cyy</strong> (<em>array</em>) – Covariance matrix of regressor.</p></li>
<li><p><strong>keep</strong> (<em>array</em>) – Number of regressor PCs to keep (default=None, which keeps all).</p></li>
<li><p><strong>threshold</strong> (<em>float</em>) – Eigenvalue threshold for discarding regressor PCs (default=0, which keeps all
components).</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><strong>R</strong> – Matrix to apply to regressor to best model data.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>array</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="meegkit.utils.covariances.tscov">
<span class="sig-prename descclassname"><span class="pre">meegkit.utils.covariances.</span></span><span class="sig-name descname"><span class="pre">tscov</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">X</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">shifts</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">weights</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">assume_centered</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#meegkit.utils.covariances.tscov" title="Link to this definition">#</a></dt>
<dd><p>Time shift covariance.</p>
<p>This function calculates, for each pair [X[i], X[j]] of columns of X, the
cross-covariance matrix between the time-shifted versions of X[i].</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>X</strong> (<em>array</em><em>, </em><em>shape=</em><em>(</em><em>n_times</em><em>, </em><em>n_chans</em><em>[</em><em>, </em><em>n_trials</em><em>]</em><em>)</em>) – Data, can be 1D, 2D or 3D.</p></li>
<li><p><strong>shifts</strong> (<em>array</em><em>, </em><em>shape=</em><em>(</em><em>n_shifts</em><em>,</em><em>) </em><em>| </em><em>None</em>) – Array of time shifts.</p></li>
<li><p><strong>weights</strong> (<em>array</em><em>, </em><em>shape=</em><em>(</em><em>n_times</em><em>,</em><em>) </em><em>or</em>) – <dl class="simple">
<dt>shape=(n_times, 1, n_trials), or</dt><dd><p>shape=(n_times, n_chans, n_trials)</p>
</dd>
</dl>
<p>Weights, 1D (if X is 1D or 2D) or 2D (if X is 3D). The weights are not
shifted.</p>
</p></li>
<li><p><strong>assume_centered</strong> (<em>bool</em>) – If False, remove the mean of X before computing the covariance
(default=True).</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><ul class="simple">
<li><p><strong>C</strong> (<em>array, shape=(n_chans * n_shifts, n_chans * n_shifts)</em>) – Covariance matrix. This matrix is made up of a (n_times, n_times)
matrix of submatrices of dimensions (n_shifts, n_shifts).</p></li>
<li><p><strong>tw</strong> (<em>array</em>) – Total weight (C/tw is the normalized covariance).</p></li>
</ul>
</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="meegkit.utils.covariances.tsxcov">
<span class="sig-prename descclassname"><span class="pre">meegkit.utils.covariances.</span></span><span class="sig-name descname"><span class="pre">tsxcov</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">X</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">Y</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">shifts</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">weights</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">assume_centered</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#meegkit.utils.covariances.tsxcov" title="Link to this definition">#</a></dt>
<dd><p>Calculate cross-covariance of X and time-shifted Y.</p>
<p>This function calculates, for each pair of columns (Xi, Yj) of X and Y, the
scalar products between Xi and time-shifted versions of Yj.</p>
<p>Output is a 2D matrix with dimensions .</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>X</strong> (<em>arrays</em><em>, </em><em>shape=</em><em>(</em><em>n_times</em><em>, </em><em>n_chans</em><em>[</em><em>, </em><em>n_trials</em><em>]</em><em>)</em>) – Data to cross correlate. X can be 1D, 2D or 3D.</p></li>
<li><p><strong>Y</strong> (<em>arrays</em><em>, </em><em>shape=</em><em>(</em><em>n_times</em><em>, </em><em>n_chans</em><em>[</em><em>, </em><em>n_trials</em><em>]</em><em>)</em>) – Data to cross correlate. X can be 1D, 2D or 3D.</p></li>
<li><p><strong>shifts</strong> (<em>array</em>) – Time shifts.</p></li>
<li><p><strong>weights</strong> (<em>array</em>) – The weights that are applied to X. 1D (if X is 1D or 2D) or 2D (if X is
3D).</p></li>
<li><p><strong>assume_centered</strong> (<em>bool</em>) – If False, remove the mean of X before computing the covariance
(default=True).</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><ul class="simple">
<li><p><strong>C</strong> (<em>array, shape=(n_chans_x, n_chans_y * n_shifts)</em>) – Cross-covariance matrix.</p></li>
<li><p><strong>tw</strong> (<em>total weight</em>)</p></li>
</ul>
</p>
</dd>
</dl>
</dd></dl>

<div class="line-block">
<div class="line"><br /></div>
</div>
</section>
<hr class="docutils" />
<section id="module-meegkit.utils.denoise">
<span id="denoising"></span><h2>Denoising<a class="headerlink" href="#module-meegkit.utils.denoise" title="Link to this heading">#</a></h2>
<p>Denoising utilities.</p>
<div class="pst-scrollable-table-container"><table class="autosummary longtable table autosummary">
<tbody>
</tbody>
</table>
</div>
<dl class="py function">
<dt class="sig sig-object py" id="meegkit.utils.denoise.demean">
<span class="sig-prename descclassname"><span class="pre">meegkit.utils.denoise.</span></span><span class="sig-name descname"><span class="pre">demean</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">X</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">weights</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">return_mean</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">inplace</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#meegkit.utils.denoise.demean" title="Link to this definition">#</a></dt>
<dd><p>Remove weighted mean over rows (samples).</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>X</strong> (<em>array</em><em>, </em><em>shape=</em><em>(</em><em>n_samples</em><em>, </em><em>n_channels</em><em>[</em><em>, </em><em>n_trials</em><em>]</em><em>)</em>) – Data.</p></li>
<li><p><strong>weights</strong> (<em>array</em><em>, </em><em>shape=</em><em>(</em><em>n_samples</em><em>)</em>)</p></li>
<li><p><strong>return_mean</strong> (<em>bool</em>) – If True, also return signal mean (default=False).</p></li>
<li><p><strong>inplace</strong> (<em>bool</em>) – If True, save the resulting array in X (default=False).</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><ul class="simple">
<li><p><strong>X</strong> (<em>array, shape=(n_samples, n_channels[, n_trials])</em>) – Centered data.</p></li>
<li><p><strong>mn</strong> (<em>array</em>) – Mean value.</p></li>
</ul>
</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="meegkit.utils.denoise.find_outlier_samples">
<span class="sig-prename descclassname"><span class="pre">meegkit.utils.denoise.</span></span><span class="sig-name descname"><span class="pre">find_outlier_samples</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">X</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">toobig1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">toobig2</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">[]</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#meegkit.utils.denoise.find_outlier_samples" title="Link to this definition">#</a></dt>
<dd><p>Find outlier trials using an absolute threshold.</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="meegkit.utils.denoise.find_outlier_trials">
<span class="sig-prename descclassname"><span class="pre">meegkit.utils.denoise.</span></span><span class="sig-name descname"><span class="pre">find_outlier_trials</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">X</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">thresh</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">show</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#meegkit.utils.denoise.find_outlier_trials" title="Link to this definition">#</a></dt>
<dd><p>Find outlier trials.</p>
<p>For example thresh=2 rejects trials that deviate from the mean by
more than twice the average deviation from the mean.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>X</strong> (<em>ndarray</em><em>, </em><em>shape=</em><em>(</em><em>n_times</em><em>, </em><em>n_chans</em><em>[</em><em>, </em><em>n_trials</em><em>]</em><em>)</em>) – Data array.</p></li>
<li><p><strong>thresh</strong> (<em>float</em><em> or </em><em>array</em><em> of </em><em>floats</em>) – Keep trials less than thresh from mean.</p></li>
<li><p><strong>show</strong> (<em>bool</em>) – If True (default), plot trial deviations before and after.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><ul class="simple">
<li><p><strong>bads</strong> (<em>list of int</em>) – Indices of trials to reject.</p></li>
<li><p><strong>d</strong> (<em>array</em>) – Relative deviations from mean.</p></li>
</ul>
</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="meegkit.utils.denoise.mean_over_trials">
<span class="sig-prename descclassname"><span class="pre">meegkit.utils.denoise.</span></span><span class="sig-name descname"><span class="pre">mean_over_trials</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">X</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">weights</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#meegkit.utils.denoise.mean_over_trials" title="Link to this definition">#</a></dt>
<dd><p>Compute weighted mean over trials (last dimension).</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="meegkit.utils.denoise.wpwr">
<span class="sig-prename descclassname"><span class="pre">meegkit.utils.denoise.</span></span><span class="sig-name descname"><span class="pre">wpwr</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">X</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">weights</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#meegkit.utils.denoise.wpwr" title="Link to this definition">#</a></dt>
<dd><p>Weighted power.</p>
</dd></dl>

<div class="line-block">
<div class="line"><br /></div>
</div>
</section>
<hr class="docutils" />
<section id="module-meegkit.utils.matrix">
<span id="matrix-manipulation"></span><h2>Matrix manipulation<a class="headerlink" href="#module-meegkit.utils.matrix" title="Link to this heading">#</a></h2>
<p>Matrix operation utility functions.</p>
<div class="pst-scrollable-table-container"><table class="autosummary longtable table autosummary">
<tbody>
</tbody>
</table>
</div>
<dl class="py function">
<dt class="sig sig-object py" id="meegkit.utils.matrix.fold">
<span class="sig-prename descclassname"><span class="pre">meegkit.utils.matrix.</span></span><span class="sig-name descname"><span class="pre">fold</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">X</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">epoch_size</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#meegkit.utils.matrix.fold" title="Link to this definition">#</a></dt>
<dd><p>Fold 2D (n_times, n_channels) X into 3D (n_times, n_chans, n_trials).</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="meegkit.utils.matrix.matmul3d">
<span class="sig-prename descclassname"><span class="pre">meegkit.utils.matrix.</span></span><span class="sig-name descname"><span class="pre">matmul3d</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">X</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mixin</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#meegkit.utils.matrix.matmul3d" title="Link to this definition">#</a></dt>
<dd><p>Apply mixing matrix to each trial of X.</p>
<p>This is a simple wrapper or np.einsum.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>X</strong> (<em>array</em><em>, </em><em>shape=</em><em>(</em><em>n_samples</em><em>, </em><em>n_chans</em><em>, </em><em>n_trials</em><em>)</em>)</p></li>
<li><p><strong>mixing</strong> (<em>array</em><em>, </em><em>shape=</em><em>(</em><em>n_chans</em><em>, </em><em>n_components</em><em>)</em>)</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><strong>proj</strong> – Projection.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>array, shape=(n_samples, n_components, n_trials)</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="meegkit.utils.matrix.multishift">
<span class="sig-prename descclassname"><span class="pre">meegkit.utils.matrix.</span></span><span class="sig-name descname"><span class="pre">multishift</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">X</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">shifts</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">fill_value</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">axis</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">keep_dims</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">reshape</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">solution</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'full'</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#meegkit.utils.matrix.multishift" title="Link to this definition">#</a></dt>
<dd><p>Apply several shifts along specified axis.</p>
<p>If <cite>shifts</cite> has multiple values, the output will contain one shift per
page. Shifted data are padded with <cite>fill_value</cite>.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>X</strong> (<em>array</em><em>, </em><em>shape=</em><em>(</em><em>n_samples</em><em>[</em><em>, </em><em>n_chans</em><em>]</em><em>[</em><em>, </em><em>n_trials</em><em>]</em><em>)</em>) – Array to shift.</p></li>
<li><p><strong>shifts</strong> (<em>array</em><em>, </em><em>shape=</em><em>(</em><em>n_shifts</em><em>,</em><em>)</em>) – Array of shifts. Positive shifts mean that X is ‘delayed’ in time (i.e.
<cite>y[shift] = X[0]</cite>). Conversely, a negative shift means that X is
‘advanced’ (i.e. y[0] =</p></li>
<li><p><strong>fill_value</strong> (<em>float</em><em> | </em><em>np.nan</em>) – Value to pad output axis by.</p></li>
<li><p><strong>axis</strong> (<em>int</em><em>, </em><em>optional</em>) – The axis along which elements are shifted.</p></li>
<li><p><strong>keep_dims</strong> (<em>bool</em>) – If True, keep singleton dimensions in output.</p></li>
<li><p><strong>reshape</strong> (<em>bool</em>) – If True, concatenate channels and lags, yielding an array of shape
(n_samples, n_chans*n_shifts[, n_trials])</p></li>
<li><p><strong>solution</strong> (<em>{'valid'</em><em>, </em><em>'full'}</em>) – If <cite>valid</cite>, the output’s is cropped along <cite>axis</cite> by <cite>n_shifts</cite> in order
to remove edge artifacts. If <cite>full</cite>, the output has the same size as X.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><strong>y</strong> – Shifted array.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>array, shape=(n_samples[, n_chans][, n_trials], n_shifts)</p>
</dd>
</dl>
<div class="admonition seealso">
<p class="admonition-title">See also</p>
<p><a class="reference internal" href="#meegkit.utils.matrix.relshift" title="meegkit.utils.matrix.relshift"><code class="xref py py-obj docutils literal notranslate"><span class="pre">relshift</span></code></a>, <a class="reference internal" href="#meegkit.utils.matrix.shift" title="meegkit.utils.matrix.shift"><code class="xref py py-obj docutils literal notranslate"><span class="pre">shift</span></code></a>, <a class="reference internal" href="#meegkit.utils.matrix.shiftnd" title="meegkit.utils.matrix.shiftnd"><code class="xref py py-obj docutils literal notranslate"><span class="pre">shiftnd</span></code></a></p>
</div>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="meegkit.utils.matrix.multismooth">
<span class="sig-prename descclassname"><span class="pre">meegkit.utils.matrix.</span></span><span class="sig-name descname"><span class="pre">multismooth</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">X</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">smooths</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">axis</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">keep_dims</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#meegkit.utils.matrix.multismooth" title="Link to this definition">#</a></dt>
<dd><p>Apply several shifts along specified axis.</p>
<p>If <cite>shifts</cite> has multiple values, the output will contain one shift per
trial. Shifted data are padded with <cite>fill_value</cite>.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>X</strong> (<em>array</em><em>, </em><em>shape=</em><em>(</em><em>n_samples</em><em>[</em><em>, </em><em>n_epochs</em><em>]</em><em>[</em><em>, </em><em>n_trials</em><em>]</em><em>)</em>) – Array to shift.</p></li>
<li><p><strong>smooths</strong> (<em>array</em>) – Array of smoothing values (in samples).</p></li>
<li><p><strong>axis</strong> (<em>int</em><em>, </em><em>optional</em>) – The axis along which elements are shifted (default=0).</p></li>
<li><p><strong>keep_dims</strong> (<em>bool</em>) – If True, keep singleton dimensions in output.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><strong>y</strong> – Shifted array.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>array, shape=(n_samples[, n_epochs][, n_trials], n_shifts)</p>
</dd>
</dl>
<div class="admonition seealso">
<p class="admonition-title">See also</p>
<p><a class="reference internal" href="#meegkit.utils.matrix.multishift" title="meegkit.utils.matrix.multishift"><code class="xref py py-obj docutils literal notranslate"><span class="pre">multishift</span></code></a>, <code class="xref py py-obj docutils literal notranslate"><span class="pre">smooth</span></code></p>
</div>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="meegkit.utils.matrix.normcol">
<span class="sig-prename descclassname"><span class="pre">meegkit.utils.matrix.</span></span><span class="sig-name descname"><span class="pre">normcol</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">X</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">weights</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">return_norm</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#meegkit.utils.matrix.normcol" title="Link to this definition">#</a></dt>
<dd><p>Normalize each column so that its weighted mean square value is 1.</p>
<p>If X is 3D, pages are concatenated vertically before calculating the
norm.</p>
<p>Weight should be either a column vector, or a matrix (2D or 3D) of same
size as X.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>X</strong> (<em>array</em>) – X to normalize.</p></li>
<li><p><strong>weights</strong> (<em>array</em>) – Weights.</p></li>
<li><p><strong>return_norm</strong> (<em>bool</em>) – If True, also return norm vector.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><ul class="simple">
<li><p><strong>X_norm</strong> (<em>array</em>) – Normalized X.</p></li>
<li><p><strong>norm</strong> (<em>array</em>) – Norm.</p></li>
</ul>
</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="meegkit.utils.matrix.relshift">
<span class="sig-prename descclassname"><span class="pre">meegkit.utils.matrix.</span></span><span class="sig-name descname"><span class="pre">relshift</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">X</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ref</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">shifts</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">fill_value</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">axis</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#meegkit.utils.matrix.relshift" title="Link to this definition">#</a></dt>
<dd><p>Create shifted versions of X relative to ref with padding.</p>
<p><cite>ref</cite> is replicated to have the same shape as <cite>X</cite> and padded accordingly.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>X</strong> (<em>array</em><em>, </em><em>shape=</em><em>(</em><em>n_samples</em><em>[</em><em>, </em><em>n_epochs</em><em>]</em><em>[</em><em>, </em><em>n_trials</em><em>]</em><em>)</em>) – Array to shift.</p></li>
<li><p><strong>ref</strong> (<em>array</em><em>, </em><em>shape=</em><em>(</em><em>n_samples</em><em>[</em><em>, </em><em>n_epochs</em><em>]</em><em>[</em><em>, </em><em>n_trials</em><em>]</em><em>)</em>) – Reference array against which <cite>X</cite> is shifted.</p></li>
<li><p><strong>shifts</strong> (<em>array</em><em> | </em><em>int</em>) – Array of shifts. Positive shifts mean that X is ‘delayed’ in time (i.e.
<cite>y[shift] = X[0]</cite>). Conversely, a negative shift means that X is
‘advanced’ (i.e. y[0] =</p></li>
<li><p><strong>fill_value</strong> (<em>float</em>) – Value to pad output axis by.</p></li>
<li><p><strong>axis</strong> (<em>int</em>) – The axis along which elements are shifted.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><ul class="simple">
<li><p><strong>y</strong> (<em>array, shape=(n_samples[, n_epochs][, n_trials], n_shifts)</em>) – Shifted array.</p></li>
<li><p><strong>y_ref</strong> (<em>array, shape=(n_samples[, n_epochs][, n_trials], n_shifts)</em>) – Reference array, repeated to match <cite>y.shape</cite>. Padding matches that of
<cite>y</cite>.</p></li>
</ul>
</p>
</dd>
</dl>
<div class="admonition seealso">
<p class="admonition-title">See also</p>
<p><a class="reference internal" href="#meegkit.utils.matrix.multishift" title="meegkit.utils.matrix.multishift"><code class="xref py py-obj docutils literal notranslate"><span class="pre">multishift</span></code></a>, <a class="reference internal" href="#meegkit.utils.matrix.shift" title="meegkit.utils.matrix.shift"><code class="xref py py-obj docutils literal notranslate"><span class="pre">shift</span></code></a>, <a class="reference internal" href="#meegkit.utils.matrix.shiftnd" title="meegkit.utils.matrix.shiftnd"><code class="xref py py-obj docutils literal notranslate"><span class="pre">shiftnd</span></code></a></p>
</div>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="meegkit.utils.matrix.shift">
<span class="sig-prename descclassname"><span class="pre">meegkit.utils.matrix.</span></span><span class="sig-name descname"><span class="pre">shift</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">X</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">shift</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">fill_value</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">axis</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#meegkit.utils.matrix.shift" title="Link to this definition">#</a></dt>
<dd><p>Shift array along its first, second or last dimension.</p>
<p>Output is padded by <cite>fill_value</cite>.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>X</strong> (<em>array</em><em>, </em><em>shape=</em><em>(</em><em>n_samples</em><em>[</em><em>, </em><em>n_epochs</em><em>]</em><em>[</em><em>, </em><em>n_trials</em><em>]</em><em>)</em>) – Multidimensional input array.</p></li>
<li><p><strong>shift</strong> (<em>int</em>) – The number of places by which elements are shifted along axis. Positive
shifts mean that X is ‘delayed’ in time (i.e. <cite>y[shift] = X[0]</cite>).
Conversely, a negative shift means that X is ‘advanced’ (i.e. y[0] =
X[shift]).</p></li>
<li><p><strong>fill_value</strong> (<em>float</em>) – Value to pad output axis by.</p></li>
<li><p><strong>axis</strong> (<em>int</em><em>, </em><em>optional</em>) – The axis along which elements are shifted.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><strong>y</strong> – Output array, with the same shape as <cite>X</cite>.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>array</p>
</dd>
</dl>
<div class="admonition seealso">
<p class="admonition-title">See also</p>
<p><a class="reference internal" href="#meegkit.utils.matrix.relshift" title="meegkit.utils.matrix.relshift"><code class="xref py py-obj docutils literal notranslate"><span class="pre">relshift</span></code></a>, <a class="reference internal" href="#meegkit.utils.matrix.multishift" title="meegkit.utils.matrix.multishift"><code class="xref py py-obj docutils literal notranslate"><span class="pre">multishift</span></code></a>, <a class="reference internal" href="#meegkit.utils.matrix.shiftnd" title="meegkit.utils.matrix.shiftnd"><code class="xref py py-obj docutils literal notranslate"><span class="pre">shiftnd</span></code></a></p>
</div>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="meegkit.utils.matrix.shiftnd">
<span class="sig-prename descclassname"><span class="pre">meegkit.utils.matrix.</span></span><span class="sig-name descname"><span class="pre">shiftnd</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">X</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">shift</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">fill_value</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">axis</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#meegkit.utils.matrix.shiftnd" title="Link to this definition">#</a></dt>
<dd><p>Roll array elements along a given axis with padding.</p>
<p>Elements off the end of the array are treated as zeros. This function is
slower than function:<cite>shift</cite>, so prefer the latter when possible.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>X</strong> (<em>array</em>) – Multidimensional input array.</p></li>
<li><p><strong>shift</strong> (<em>int</em>) – The number of places by which elements are shifted along axis.</p></li>
<li><p><strong>fill_value</strong> (<em>float</em>) – Value to pad output axis by.</p></li>
<li><p><strong>axis</strong> (<em>int</em><em>, </em><em>optional</em>) – The axis along which elements are shifted. By default, the array is
flattened before shifting, after which the original shape is restored.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><strong>y</strong> – Output array, with the same shape as <cite>X</cite>.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>array, (n_samples, [n_epochs, ][n_trials, ])</p>
</dd>
</dl>
<div class="admonition seealso">
<p class="admonition-title">See also</p>
<dl class="simple">
<dt><code class="xref py py-obj docutils literal notranslate"><span class="pre">np.roll</span></code></dt><dd><p>Elements that roll off one end come back on the other.</p>
</dd>
<dt><code class="xref py py-obj docutils literal notranslate"><span class="pre">np.rollaxis</span></code></dt><dd><p>Roll the specified axis backwards, until it lies in a given position.</p>
</dd>
</dl>
</div>
<p class="rubric">Examples</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">x</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mi">10</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">shiftnd</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="mi">2</span><span class="p">)</span>
<span class="go">array([0, 0, 0, 1, 2, 3, 4, 5, 6, 7])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">x2</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="p">(</span><span class="mi">2</span><span class="p">,</span><span class="mi">5</span><span class="p">))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">x2</span>
<span class="go">array([[0, 1, 2, 3, 4],</span>
<span class="go">       [5, 6, 7, 8, 9]])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">shiftnd</span><span class="p">(</span><span class="n">x2</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
<span class="go">array([[0, 0, 1, 2, 3],</span>
<span class="go">       [4, 5, 6, 7, 8]])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">shiftnd</span><span class="p">(</span><span class="n">x2</span><span class="p">,</span> <span class="o">-</span><span class="mi">2</span><span class="p">)</span>
<span class="go">array([[2, 3, 4, 5, 6],</span>
<span class="go">       [7, 8, 9, 0, 0]])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">shiftnd</span><span class="p">(</span><span class="n">x2</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
<span class="go">array([[0, 0, 0, 0, 0],</span>
<span class="go">       [0, 1, 2, 3, 4]])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">shiftnd</span><span class="p">(</span><span class="n">x2</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
<span class="go">array([[5, 6, 7, 8, 9],</span>
<span class="go">       [0, 0, 0, 0, 0]])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">shiftnd</span><span class="p">(</span><span class="n">x2</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
<span class="go">array([[0, 0, 1, 2, 3],</span>
<span class="go">       [0, 5, 6, 7, 8]])</span>
</pre></div>
</div>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="meegkit.utils.matrix.sliding_window">
<span class="sig-prename descclassname"><span class="pre">meegkit.utils.matrix.</span></span><span class="sig-name descname"><span class="pre">sliding_window</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">data</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">window</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">step</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">axis</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">-1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">copy</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#meegkit.utils.matrix.sliding_window" title="Link to this definition">#</a></dt>
<dd><p>Calculate a sliding window over a signal.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>data</strong> (<em>array</em>) – The array to be slided over.</p></li>
<li><p><strong>window</strong> (<em>int</em>) – The sliding window size.</p></li>
<li><p><strong>step</strong> (<em>int</em>) – The sliding window stepsize (default=1).</p></li>
<li><p><strong>axis</strong> (<em>int</em>) – The axis to slide over (defaults=-1).</p></li>
<li><p><strong>copy</strong> (<em>bool</em>) – Return strided array as copy to avoid sideffects when manipulating the
output array.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><strong>data</strong> – A matrix whose last dimension corresponds to the window size, and the
second-to-last dimension corresponds to the number of slices.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>array, shape=(…, n_windows, window_size)</p>
</dd>
</dl>
<p class="rubric">Notes</p>
<p>Be wary of setting <cite>copy</cite> to <cite>False</cite> as undesired side effects with the
output values may occur.</p>
<p class="rubric">Examples</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">a</span> <span class="o">=</span> <span class="n">numpy</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">5</span><span class="p">])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">sliding_window</span><span class="p">(</span><span class="n">a</span><span class="p">,</span> <span class="n">size</span><span class="o">=</span><span class="mi">3</span><span class="p">)</span>
<span class="go">array([[1, 2, 3],</span>
<span class="go">       [2, 3, 4],</span>
<span class="go">       [3, 4, 5]])</span>
</pre></div>
</div>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">sliding_window</span><span class="p">(</span><span class="n">a</span><span class="p">,</span> <span class="n">size</span><span class="o">=</span><span class="mi">3</span><span class="p">,</span> <span class="n">stepsize</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span>
<span class="go">array([[1, 2, 3],</span>
<span class="go">       [3, 4, 5]])</span>
</pre></div>
</div>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="meegkit.utils.matrix.theshapeof">
<span class="sig-prename descclassname"><span class="pre">meegkit.utils.matrix.</span></span><span class="sig-name descname"><span class="pre">theshapeof</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">X</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#meegkit.utils.matrix.theshapeof" title="Link to this definition">#</a></dt>
<dd><p>Return the shape of X.</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="meegkit.utils.matrix.unfold">
<span class="sig-prename descclassname"><span class="pre">meegkit.utils.matrix.</span></span><span class="sig-name descname"><span class="pre">unfold</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">X</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#meegkit.utils.matrix.unfold" title="Link to this definition">#</a></dt>
<dd><p>Unfold 3D X into 2D (concatenate trials).</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="meegkit.utils.matrix.unsqueeze">
<span class="sig-prename descclassname"><span class="pre">meegkit.utils.matrix.</span></span><span class="sig-name descname"><span class="pre">unsqueeze</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">X</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#meegkit.utils.matrix.unsqueeze" title="Link to this definition">#</a></dt>
<dd><p>Append singleton dimensions to an array.</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="meegkit.utils.matrix.widen_mask">
<span class="sig-prename descclassname"><span class="pre">meegkit.utils.matrix.</span></span><span class="sig-name descname"><span class="pre">widen_mask</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">mask</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">widen</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">4</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">axis</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#meegkit.utils.matrix.widen_mask" title="Link to this definition">#</a></dt>
<dd><p>Widen each ‘bad’ section of a binary mask by <cite>n</cite> cells.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>mask</strong> (<em>array</em>) – Masking array. If an element of the mask is True (or 1), the
corresponding element of the associated array is masked (marked as
invalid).</p></li>
<li><p><strong>widen</strong> (<em>int</em>) – Number of cells to widen mask by.</p></li>
<li><p><strong>axis</strong> (<em>int</em>) – Axis to operate on.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><strong>out</strong> – Widened mask, of same shape as input mask.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>array</p>
</dd>
</dl>
<p class="rubric">Examples</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">test</span> <span class="o">=</span> <span class="n">widen_mask</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="kc">False</span><span class="p">,</span> <span class="kc">False</span><span class="p">,</span> <span class="kc">False</span><span class="p">,</span> <span class="kc">True</span><span class="p">,</span> <span class="kc">False</span><span class="p">],</span> <span class="mi">1</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">test</span><span class="p">)</span>
<span class="go">[False False False True True]]</span>
</pre></div>
</div>
</dd></dl>

<div class="line-block">
<div class="line"><br /></div>
</div>
</section>
<hr class="docutils" />
<section id="module-meegkit.utils.sig">
<span id="signal"></span><h2>Signal<a class="headerlink" href="#module-meegkit.utils.sig" title="Link to this heading">#</a></h2>
<p>Audio and signal processing tools.</p>
<div class="pst-scrollable-table-container"><table class="autosummary longtable table autosummary">
<tbody>
</tbody>
</table>
</div>
<dl class="py function">
<dt class="sig sig-object py" id="meegkit.utils.sig.gaussfilt">
<span class="sig-prename descclassname"><span class="pre">meegkit.utils.sig.</span></span><span class="sig-name descname"><span class="pre">gaussfilt</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">data</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">sfreq</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">f</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">fwhm</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">n_harm</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">shift</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">return_empvals</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">show</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#meegkit.utils.sig.gaussfilt" title="Link to this definition">#</a></dt>
<dd><p>Narrow-band filter via frequency-domain Gaussian.</p>
<p>Empirical frequency and FWHM depend on the sampling rate and the number of
time points, and may thus be slightly different from the requested values.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>data</strong> (<em>ndarray</em>) – EEG data, shape=(n_samples, n_channels[, …])</p></li>
<li><p><strong>sfreq</strong> (<em>int</em>) – Sampling rate in Hz.</p></li>
<li><p><strong>f</strong> (<em>float</em>) – Break frequency of filter.</p></li>
<li><p><strong>fhwm</strong> (<em>float</em>) – Standard deviation of filter, defined as full-width at half-maximum
in Hz.</p></li>
<li><p><strong>n_harm</strong> (<em>int</em>) – Number of harmonics of the frequency to consider.</p></li>
<li><p><strong>shift</strong> (<em>int</em>) – Amount shift peak frequency by (only useful when considering harmonics,
otherwise leave to 0).</p></li>
<li><p><strong>return_empvals</strong> (<em>bool</em>) – Return empirical values (default: False).</p></li>
<li><p><strong>show</strong> (<em>bool</em>) – Set to True to show the frequency-domain filter shape.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><ul class="simple">
<li><p><strong>filtdat</strong> (<em>ndarray</em>) – Filtered data.</p></li>
<li><p><strong>empVals</strong> (<em>float</em>) – The empirical frequency and FWHM.</p></li>
</ul>
</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="meegkit.utils.sig.hilbert_envelope">
<span class="sig-prename descclassname"><span class="pre">meegkit.utils.sig.</span></span><span class="sig-name descname"><span class="pre">hilbert_envelope</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">x</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#meegkit.utils.sig.hilbert_envelope" title="Link to this definition">#</a></dt>
<dd><p>Calculate the Hilbert envelope of a signal.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>x</strong> (<em>array</em>) – Signal on which to calculate the hilbert envelope. The calculation
is done along the last axis (i.e. <code class="docutils literal notranslate"><span class="pre">axis=-1</span></code>).</p>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p>ndarray</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="meegkit.utils.sig.lowpass_env_filtering">
<span class="sig-prename descclassname"><span class="pre">meegkit.utils.sig.</span></span><span class="sig-name descname"><span class="pre">lowpass_env_filtering</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">x</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">cutoff</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">150.0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">n</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">sfreq</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">22050</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#meegkit.utils.sig.lowpass_env_filtering" title="Link to this definition">#</a></dt>
<dd><p>Low-pass filters a signal using a Butterworth filter.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>x</strong> (<em>ndarray</em>)</p></li>
<li><p><strong>cutoff</strong> (<em>float</em><em>, </em><em>optional</em>) – Cut-off frequency of the low-pass filter, in Hz. The default is 150 Hz.</p></li>
<li><p><strong>n</strong> (<em>int</em><em>, </em><em>optional</em>) – Order of the low-pass filter. The default is 1.</p></li>
<li><p><strong>sfreq</strong> (<em>float</em><em>, </em><em>optional</em>) – Sampling frequency of the signal to filter. The default is 22050 Hz.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Low-pass filtered signal.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>ndarray</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="meegkit.utils.sig.modulation_index">
<span class="sig-prename descclassname"><span class="pre">meegkit.utils.sig.</span></span><span class="sig-name descname"><span class="pre">modulation_index</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">phase</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">amp</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">n_bins</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">18</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#meegkit.utils.sig.modulation_index" title="Link to this definition">#</a></dt>
<dd><p>Compute the Modulation Index (MI) between two signals.</p>
<p>MI is a measure of the amount of phase-amplitude coupling. Phase angles are
expected to be in radians <a class="reference internal" href="#r44b01ae0e3d3-1" id="id5">[1]</a>. MI is derived from the Kullbach-Leibner
distance, a measure for the disparity of two distributions, which is also
returned here. MI is recommend the modulation index for noisy and short
data epochs with unknown forms of coupling <a class="reference internal" href="#r44b01ae0e3d3-2" id="id6">[2]</a>.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>phase</strong> (<em>array</em>) – Phase vector, in radians.</p></li>
<li><p><strong>amp</strong> (<em>array</em>) – Amplitude vector.</p></li>
<li><p><strong>n_bins</strong> (<em>int</em>) – Number of bins in which to discretize phase (default=18 bins, giving
a 20-degree resolution).</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><ul class="simple">
<li><p><strong>MI</strong> (<em>array</em>) – Tort’s Modulation index.</p></li>
<li><p><strong>KL</strong> (<em>array</em>) – Kullbach-Leibner distance.</p></li>
</ul>
</p>
</dd>
</dl>
<p class="rubric">Examples</p>
<p>&gt;&gt; phas = np.random.rand(100, 1) * 2 * np.pi - np.pi
&gt;&gt; ampl = rng.standard_normal((100, 1) * 30 + 100
&gt;&gt; MI, KL = modulation_index(phas, ampl)</p>
<p class="rubric">Notes</p>
<p>Phase and amplitude can be derived directly from any time series through
the analytic signal:
&gt;&gt; analytic_signal = hilbert(filtered_data)
&gt;&gt; phase = np.phase(analytic_signal)
&gt;&gt; amplitude = np.abs(analytic_signal)</p>
<p>MI can be subjected to permutation testing to assess significance. For
permutation testing, the observed coupling value is compared to a
distribution of shuffled coupling values. Shuffled coupling values are
constructed by calculating the coupling value between the original phase
time series and a permuted amplitude time series. The permuted amplitude
time series can be constructed by cutting the amplitude time series at a
random time point and reversing the order of both parts <a class="reference internal" href="#r44b01ae0e3d3-2" id="id7">[2]</a>. The observed
coupling value is standardized to the distribution of the shuffled coupling
values according to the following formula:</p>
<p>MI_z = (MI_observed − µ_MI_shuffled) / σ_MI_shuffled</p>
<p>where μ denotes the mean and σ the standard deviation. Only when the
observed phase-locking value is larger than 95% of shuffled values, it is
defined as significant. See <a class="reference internal" href="#r44b01ae0e3d3-2" id="id8">[2]</a> for details.</p>
<p class="rubric">References</p>
<div role="list" class="citation-list">
<div class="citation" id="r44b01ae0e3d3-1" role="doc-biblioentry">
<span class="label"><span class="fn-bracket">[</span><a role="doc-backlink" href="#id5">1</a><span class="fn-bracket">]</span></span>
<p>Tort AB, Komorowski R, Eichenbaum H, Kopell N. Measuring
phase-amplitude coupling between neuronal oscillations of different
frequencies. J Neurophysiol. 2010 Aug;104(2):1195-210. doi:
10.1152/jn.00106.2010.</p>
</div>
<div class="citation" id="r44b01ae0e3d3-2" role="doc-biblioentry">
<span class="label"><span class="fn-bracket">[</span>2<span class="fn-bracket">]</span></span>
<span class="backrefs">(<a role="doc-backlink" href="#id6">1</a>,<a role="doc-backlink" href="#id7">2</a>,<a role="doc-backlink" href="#id8">3</a>)</span>
<p>Huelsemann, M. J., Naumann, E., &amp; Rasch, B. (2018). Quantification
of Phase-Amplitude Coupling in Neuronal Oscillations: Comparison of
Phase-Locking Value, Mean Vector Length, and Modulation Index. bioRxiv,
290361.</p>
</div>
</div>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="meegkit.utils.sig.prony">
<span class="sig-prename descclassname"><span class="pre">meegkit.utils.sig.</span></span><span class="sig-name descname"><span class="pre">prony</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">h</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">nb</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">na</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#meegkit.utils.sig.prony" title="Link to this definition">#</a></dt>
<dd><p>Prony’s method for time-domain IIR filter design.</p>
<p>[B,A] = PRONY(H, NB, NA) finds a filter with numerator order NB,
denominator order NA, and having the impulse response in vector H. The IIR
filter coefficients are returned in length NB+1 and NA+1 row vectors B and
A, ordered in descending powers of Z.  H may be real or complex.</p>
<p>If the largest order specified is greater than the length of H, H is padded
with zeros.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>h</strong> (<em>array</em>) – Impulse response.</p></li>
<li><p><strong>nb</strong> (<em>int</em>) – Numerator order.</p></li>
<li><p><strong>na</strong> (<em>int</em>) – Denominator order.</p></li>
</ul>
</dd>
</dl>
<p class="rubric">References</p>
<p>T.W. Parks and C.S. Burrus, Digital Filter Design, John Wiley and Sons,
1987, p226.</p>
<p class="rubric">Notes</p>
<p>Copyright 1988-2012 The MathWorks, Inc.</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="meegkit.utils.sig.slope_sum">
<span class="sig-prename descclassname"><span class="pre">meegkit.utils.sig.</span></span><span class="sig-name descname"><span class="pre">slope_sum</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">x</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">w</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">axis</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#meegkit.utils.sig.slope_sum" title="Link to this definition">#</a></dt>
<dd><p>Slope sum function.</p>
<p>The discrete version of the Teager-Kaiser operator is computed according
to:</p>
<p>y[n] = \sum_{i=k-w}^k (y_i -y_{i-1})</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>x</strong> (<em>array</em><em>, </em><em>shape=</em><em>(</em><em>n_samples</em><em>[</em><em>, </em><em>n_channels</em><em>]</em><em>[</em><em>, </em><em>n_trials</em><em>]</em><em>)</em>) – Input data.</p></li>
<li><p><strong>w</strong> (<em>int</em>) – Window.</p></li>
</ul>
</dd>
</dl>
<p class="rubric">References</p>
<p><a class="reference external" href="https://ieeexplore.ieee.org/document/8527395">https://ieeexplore.ieee.org/document/8527395</a></p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="meegkit.utils.sig.smooth">
<span class="sig-prename descclassname"><span class="pre">meegkit.utils.sig.</span></span><span class="sig-name descname"><span class="pre">smooth</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">x</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">window_len</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">window</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'square'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">axis</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">align</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'left'</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#meegkit.utils.sig.smooth" title="Link to this definition">#</a></dt>
<dd><p>Smooth a signal using a window with requested size along a given axis.</p>
<p>This method is based on the convolution of a scaled window with the signal.
The signal is prepared by introducing reflected copies of the signal (with
the window size) in both ends so that transient parts are minimized in the
beginning and end part of the output signal.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>x</strong> (<em>array</em>) – The input signal.</p></li>
<li><p><strong>window_len</strong> (<em>float</em>) – The dimension of the smoothing window (in samples). Can be fractionary.</p></li>
<li><p><strong>window</strong> (<em>str</em>) – The type of window from ‘flat’, ‘hanning’, ‘hamming’, ‘bartlett’,
‘blackman’ flat window will produce a moving average smoothing.</p></li>
<li><p><strong>axis</strong> (<em>int</em>) – Axis along which smoothing will be applied (default=0).</p></li>
<li><p><strong>align</strong> (<em>{'left'</em><em> | </em><em>'center'}</em>) – If <cite>left</cite> (default), the convolution if computed in a causal way by
shifting the output of a normal convolution by the kernel size. If
<cite>center</cite>, the center of the impulse is used as the location where the
convolution is summed.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><strong>y</strong> – The smoothed signal.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>array</p>
</dd>
</dl>
<p class="rubric">Examples</p>
<p>&gt;&gt; t = linspace(-2, 2, 0.1)
&gt;&gt; x = sin(t) + randn(len(t)) * 0.1
&gt;&gt; y = smooth(x, 2)</p>
<div class="admonition seealso">
<p class="admonition-title">See also</p>
<p><code class="xref py py-obj docutils literal notranslate"><span class="pre">np.hanning</span></code>, <code class="xref py py-obj docutils literal notranslate"><span class="pre">np.hamming</span></code>, <code class="xref py py-obj docutils literal notranslate"><span class="pre">np.bartlett</span></code>, <code class="xref py py-obj docutils literal notranslate"><span class="pre">np.blackman</span></code>, <code class="xref py py-obj docutils literal notranslate"><span class="pre">np.convolve</span></code>, <code class="xref py py-obj docutils literal notranslate"><span class="pre">scipy.signal.lfilter</span></code></p>
</div>
<p class="rubric">Notes</p>
<p>length(output) != length(input), to correct this, we return :
&gt;&gt; y[(window_len / 2 - 1):-(window_len / 2)]  # noqa
instead of just y.</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="meegkit.utils.sig.spectral_envelope">
<span class="sig-prename descclassname"><span class="pre">meegkit.utils.sig.</span></span><span class="sig-name descname"><span class="pre">spectral_envelope</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">x</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">sfreq</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">lowpass</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">32</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#meegkit.utils.sig.spectral_envelope" title="Link to this definition">#</a></dt>
<dd><p>Compute envelope with convolution.</p>
<p class="rubric">Notes</p>
<p>The signal is first padded to avoid edge effects. To align the envelope
with the input signal, we return :
&gt;&gt; y[(window_len / 2 - 1):-(window_len / 2)]  # noqa</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="meegkit.utils.sig.stmcb">
<span class="sig-prename descclassname"><span class="pre">meegkit.utils.sig.</span></span><span class="sig-name descname"><span class="pre">stmcb</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">x</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">u_in</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">q</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">p</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">niter</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">5</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">a_in</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#meegkit.utils.sig.stmcb" title="Link to this definition">#</a></dt>
<dd><p>Compute linear model via Steiglitz-McBride iteration.</p>
<p>[B,A] = stmcb(H,NB,NA) finds the coefficients of the system B(z)/A(z) with
approximate impulse response H, NA poles and NB zeros.</p>
<p>[B,A] = stmcb(H,NB,NA,N) uses N iterations.  N defaults to 5.</p>
<p>[B,A] = stmcb(H,NB,NA,N,Ai) uses the vector Ai as the initial
guess at the denominator coefficients. If you don’t specify Ai,
STMCB uses [B,Ai] = PRONY(H,0,NA) as the initial conditions.</p>
<p>[B,A] = STMCB(X,Y,NB,NA,N,Ai) finds the system coefficients B and
A of the system which, given X as input, has Y as output. N and Ai
are again optional with default values of N = 5, [B,Ai] = PRONY(Y,0,NA).
Y and X must be the same length.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>x</strong> (<em>array</em>)</p></li>
<li><p><strong>u_in</strong> (<em>array</em>)</p></li>
<li><p><strong>q</strong> (<em>int</em>)</p></li>
<li><p><strong>p</strong> (<em>int</em>)</p></li>
<li><p><strong>n_iter</strong> (<em>int</em>)</p></li>
<li><p><strong>a_in</strong> (<em>array</em>)</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><ul class="simple">
<li><p><strong>b</strong> (<em>array</em>) – Filter coefficients (denominator).</p></li>
<li><p><strong>a</strong> (<em>array</em>) – Filter coefficients (numerator).</p></li>
</ul>
</p>
</dd>
</dl>
<p class="rubric">Examples</p>
<p>Approximate the impulse response of a Butterworth filter with a
system of lower order:</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="p">[</span><span class="n">b</span><span class="p">,</span> <span class="n">a</span><span class="p">]</span> <span class="o">=</span> <span class="n">butter</span><span class="p">(</span><span class="mi">6</span><span class="p">,</span> <span class="mf">0.2</span><span class="p">)</span>                <span class="c1"># Butterworth filter design</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">h</span> <span class="o">=</span> <span class="nb">filter</span><span class="p">(</span><span class="n">b</span><span class="p">,</span> <span class="n">a</span><span class="p">,</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="n">zeros</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">100</span><span class="p">)])</span>    <span class="c1"># Filter data using above filter</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">freqz</span><span class="p">(</span><span class="n">b</span><span class="p">,</span> <span class="n">a</span><span class="p">,</span> <span class="mi">128</span><span class="p">)</span>                       <span class="c1"># Frequency response</span>
<span class="gp">&gt;&gt;&gt; </span><span class="p">[</span><span class="n">bb</span><span class="p">,</span> <span class="n">aa</span><span class="p">]</span> <span class="o">=</span> <span class="n">stmcb</span><span class="p">(</span><span class="n">h</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">4</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">freqz</span><span class="p">(</span><span class="n">bb</span><span class="p">,</span> <span class="n">aa</span><span class="p">,</span> <span class="mi">128</span><span class="p">))</span>
</pre></div>
</div>
<p class="rubric">References</p>
<p>Authors: Jim McClellan, 2-89 T. Krauss, 4-22-93, new help and options
Copyright 1988-2004 The MathWorks, Inc.</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="meegkit.utils.sig.teager_kaiser">
<span class="sig-prename descclassname"><span class="pre">meegkit.utils.sig.</span></span><span class="sig-name descname"><span class="pre">teager_kaiser</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">x</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">m</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">M</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">axis</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#meegkit.utils.sig.teager_kaiser" title="Link to this definition">#</a></dt>
<dd><p>Mean Teager-Kaiser energy operator.</p>
<p>The discrete version of the Teager-Kaiser operator is computed according
to:</p>
<p>y[n] = x[n] ** {2 / m} - (x[n - M] * x[n + M]) ** {1 / m}</p>
<p>with m the exponent parameter and M the lag parameter which both are
usually equal to 1 for a conventional operator. The Teaser-Kaiser operator
can be used to track amplitude modulations (AM) and/or frequency
modulations (FM).</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>x</strong> (<em>array</em><em>, </em><em>shape=</em><em>(</em><em>n_samples</em><em>[</em><em>, </em><em>n_channels</em><em>]</em><em>[</em><em>, </em><em>n_trials</em><em>]</em><em>)</em>) – Input data.</p></li>
<li><p><strong>m</strong> (<em>int</em>) – Exponent parameter.</p></li>
<li><p><strong>M</strong> (<em>int</em>) – Lag parameter.</p></li>
<li><p><strong>axis</strong> (<em>int</em>) – Axis to compute metric on.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Instantaneous energy.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>array, shape=(n_samples - 2 * M[, n_channels][, n_trials])</p>
</dd>
</dl>
<p class="rubric">References</p>
<p>Adapted from the TKEO function in R library <cite>seewave</cite>.</p>
<p class="rubric">Examples</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">x</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mi">1</span><span class="p">,</span>  <span class="mi">3</span><span class="p">,</span> <span class="mi">12</span><span class="p">,</span> <span class="mi">25</span><span class="p">,</span> <span class="mi">10</span><span class="p">])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">tk_energy</span> <span class="o">=</span> <span class="n">teager_kaiser</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
</pre></div>
</div>
</dd></dl>

<div class="line-block">
<div class="line"><br /></div>
</div>
</section>
<hr class="docutils" />
<section id="module-meegkit.utils.stats">
<span id="statistics"></span><h2>Statistics<a class="headerlink" href="#module-meegkit.utils.stats" title="Link to this heading">#</a></h2>
<p>Statistics utilities.</p>
<div class="pst-scrollable-table-container"><table class="autosummary longtable table autosummary">
<tbody>
</tbody>
</table>
</div>
<dl class="py function">
<dt class="sig sig-object py" id="meegkit.utils.stats.bootstrap_ci">
<span class="sig-prename descclassname"><span class="pre">meegkit.utils.stats.</span></span><span class="sig-name descname"><span class="pre">bootstrap_ci</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">X</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">n_bootstrap</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">2000</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ci</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">(5,</span> <span class="pre">95)</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">axis</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">-1</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#meegkit.utils.stats.bootstrap_ci" title="Link to this definition">#</a></dt>
<dd><p>Confidence intervals from non-parametric bootstrap resampling.</p>
<p>Bootstrap is computed over the chosen axis, <em>with</em> replacement. By default,
the resampling is performed over the last dimension (trials), but this can
also be done over channels (axis=1).</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>X</strong> (<em>array</em><em>, </em><em>shape=</em><em>(</em><em>n_times</em><em>, </em><em>n_chans</em><em>[</em><em>, </em><em>n_trials</em><em>]</em><em>)</em>) – Input data.</p></li>
<li><p><strong>n_bootstrap</strong> (<em>int</em>) – Number of bootstrap resamplings (default=2000). For publication
quality results, it is usually recommended to have more than 5000
iterations.</p></li>
<li><p><strong>ci</strong> (<em>length-2 tuple</em>) – Confidence interval (default=(5, 95)).</p></li>
<li><p><strong>axis</strong> (<em>int</em>) – Axis to operate on.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><strong>ci_low, ci_up</strong> – Confidence intervals.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>arrays, shape=(n_times, n_chans)</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="meegkit.utils.stats.bootstrap_snr">
<span class="sig-prename descclassname"><span class="pre">meegkit.utils.stats.</span></span><span class="sig-name descname"><span class="pre">bootstrap_snr</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">epochs</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">n_bootstrap</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">2000</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">baseline</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">window</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#meegkit.utils.stats.bootstrap_snr" title="Link to this definition">#</a></dt>
<dd><p>Get bootstrap SNR from non-parametric bootstrap resampling.</p>
<p>The lower bound SNR value can serve as a minimum threshold of signal
quality. Parks et al. (2016) suggest using a threshold of 3 dB when
assessing whether to remove subjects from ERP studies.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>epochs</strong> (<em>mne.Epochs instance</em>) – Epochs instance to compute SNR from.</p></li>
<li><p><strong>n_bootstrap</strong> (<em>int</em>) – Number of bootstrap iterations (should be &gt; 10000 for publication
quality).</p></li>
<li><p><strong>baseline</strong> (<em>tuple</em><em> or </em><em>list</em><em> of </em><em>length 2</em><em>, or </em><em>None</em>) – The time interval to apply rescaling / baseline correction. If None do
not apply it. If baseline is <code class="docutils literal notranslate"><span class="pre">(bmin,</span> <span class="pre">bmax)</span></code> the interval is between
<code class="docutils literal notranslate"><span class="pre">bmin</span></code> (s) and <code class="docutils literal notranslate"><span class="pre">bmax</span></code> (s). If <code class="docutils literal notranslate"><span class="pre">bmin</span> <span class="pre">is</span> <span class="pre">None</span></code> the beginning of the
data is used and if <code class="docutils literal notranslate"><span class="pre">bmax</span> <span class="pre">is</span> <span class="pre">None</span></code> then <code class="docutils literal notranslate"><span class="pre">bmax</span></code> is set to the end of
the interval. If baseline is <code class="docutils literal notranslate"><span class="pre">(None,</span> <span class="pre">None)</span></code> the entire time interval
is used. If baseline is None, no correction is applied.</p></li>
<li><p><strong>window</strong> (<em>tuple</em><em> or </em><em>list</em><em> of </em><em>length 2</em><em>, or </em><em>None</em>) – The time interval used to compute the numerator of the SNR. If window
is <code class="docutils literal notranslate"><span class="pre">(bmin,</span> <span class="pre">bmax)</span></code> the interval is between <code class="docutils literal notranslate"><span class="pre">bmin</span></code> (s) and <code class="docutils literal notranslate"><span class="pre">bmax</span></code>
(s). If <code class="docutils literal notranslate"><span class="pre">bmin</span> <span class="pre">is</span> <span class="pre">None</span></code> the beginning of the data is used and if
<code class="docutils literal notranslate"><span class="pre">bmax</span> <span class="pre">is</span> <span class="pre">None</span></code> then <code class="docutils literal notranslate"><span class="pre">bmax</span></code> is set to the end of the interval. If
window is <code class="docutils literal notranslate"><span class="pre">(None,</span> <span class="pre">None)</span></code> the entire time interval is used. If None
use all positive times.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><ul class="simple">
<li><p><strong>ERP</strong> (<em>length-3 tuple</em>) – Mean bootstrap ERP, with 90% confidence intervals.</p></li>
<li><p><strong>SNR</strong> (<em>length-3 tuple</em>) – Mean bootstrap SNR, with 90% confidence intervals.</p></li>
</ul>
</p>
</dd>
</dl>
<p class="rubric">References</p>
<p><a class="reference external" href="https://www.ncbi.nlm.nih.gov/pmc/articles/PMC4751267/">https://www.ncbi.nlm.nih.gov/pmc/articles/PMC4751267/</a></p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="meegkit.utils.stats.cronbach">
<span class="sig-prename descclassname"><span class="pre">meegkit.utils.stats.</span></span><span class="sig-name descname"><span class="pre">cronbach</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">epochs</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">K</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">n_bootstrap</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">2000</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">tmin</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">tmax</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#meegkit.utils.stats.cronbach" title="Link to this definition">#</a></dt>
<dd><p>Compute reliability of ERP.</p>
<p>Internal reliability of the ERN and Pe as a function of increasing trial
numbers can be quantified with Cronbach’s alpha:</p>
<blockquote>
<div><dl class="simple">
<dt>$$alpha = frac{K}{K-1} left(1-frac{sum_{i=1}^K</dt><dd><p>sigma^2_{Y_i}}{ sigma^2_X}right)$$</p>
</dd>
</dl>
</div></blockquote>
<p>Hinton, Brownlow, McMurray, and Cozens (2004) have suggested that
Cronbach’s alpha exceeding .90 indicates excellent internal reliability,
between .70 and .90 indicates high internal reliability, from .50 to .70
indicates moderate internal reliability, and below .50 is low.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>epochs</strong> (<em>mne.Epochs</em><em> | </em><em>ndarray</em><em>, </em><em>shape=</em><em>(</em><em>n_trials</em><em>, </em><em>n_chans</em><em>, </em><em>n_samples</em><em>)</em>) – Epochs to compute alpha from.</p></li>
<li><p><strong>K</strong> (<em>int</em>) – Number of trials to use for alpha computation.</p></li>
<li><p><strong>n_bootstrap</strong> (<em>int</em>) – Number of bootstrap resamplings.</p></li>
<li><p><strong>tmin</strong> (<em>float</em>) – Start time of epoch.</p></li>
<li><p><strong>tmax</strong> (<em>float</em>) – End of epoch.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><ul class="simple">
<li><p><strong>alpha</strong> (<em>array, shape=(n_chans,)</em>) – Cronbach alpha value</p></li>
<li><p><strong>bounds</strong> (<em>length-2 tuple</em>) – Lower and higher bound of CI.</p></li>
</ul>
</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="meegkit.utils.stats.rms">
<span class="sig-prename descclassname"><span class="pre">meegkit.utils.stats.</span></span><span class="sig-name descname"><span class="pre">rms</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">X</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">axis</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#meegkit.utils.stats.rms" title="Link to this definition">#</a></dt>
<dd><p>Root-mean-square along given axis.</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="meegkit.utils.stats.robust_mean">
<span class="sig-prename descclassname"><span class="pre">meegkit.utils.stats.</span></span><span class="sig-name descname"><span class="pre">robust_mean</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">X</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">axis</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">percentile</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">[5,</span> <span class="pre">95]</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#meegkit.utils.stats.robust_mean" title="Link to this definition">#</a></dt>
<dd><p>Do robust mean based on JR Kings implementation.</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="meegkit.utils.stats.rolling_corr">
<span class="sig-prename descclassname"><span class="pre">meegkit.utils.stats.</span></span><span class="sig-name descname"><span class="pre">rolling_corr</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">X</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">y</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">window</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">sfreq</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">step</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">axis</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#meegkit.utils.stats.rolling_corr" title="Link to this definition">#</a></dt>
<dd><p>Calculate rolling correlation between some data and a reference signal.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>X</strong> (<em>array</em><em>, </em><em>shape=</em><em>(</em><em>n_times</em><em>, </em><em>n_chans</em><em>[</em><em>, </em><em>n_epochs</em><em>]</em><em>)</em>) – Test signal. First dimension should be time.</p></li>
<li><p><strong>y</strong> (<em>array</em><em>, </em><em>shape=</em><em>(</em><em>n_times</em><em>[</em><em>, </em><em>n_epochs</em><em>]</em><em>)</em>) – Reference signal.</p></li>
<li><p><strong>window</strong> (<em>int</em>) – Number of timepoints for to include for each correlation calculation.</p></li>
<li><p><strong>sfreq</strong> (<em>int</em>) – Sampling frequency (default=1).</p></li>
<li><p><strong>step</strong> (<em>int</em>) – If &gt; 1, only compute correlations every <cite>step</cite> samples.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><ul class="simple">
<li><p><strong>corr</strong> (<em>array, shape=(n_times - window, n_channels[, n_epochs])</em>) – Rolling window correlation.</p></li>
<li><p><strong>t_corr</strong> (<em>array</em>) – Corresponding time vector.</p></li>
</ul>
</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="meegkit.utils.stats.snr_spectrum">
<span class="sig-prename descclassname"><span class="pre">meegkit.utils.stats.</span></span><span class="sig-name descname"><span class="pre">snr_spectrum</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">X</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">freqs</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">n_avg</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">n_harm</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">skipbins</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#meegkit.utils.stats.snr_spectrum" title="Link to this definition">#</a></dt>
<dd><p>Compute Signal-to-Noise-corrected spectrum.</p>
<p>The implementation tries to replicate examples in [1; 2; 3]_.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>X</strong> (<em>ndarray</em><em> , </em><em>shape=</em><em>(</em><em>n_freqs</em><em>, </em><em>n_chans</em><em>,</em><em>[ </em><em>n_trials</em><em>,</em><em>]</em><em>)</em>) – One-sided power spectral density estimate, specified as a real-valued,
nonnegative array. The power spectral density must be expressed in
linear units, not decibels.</p></li>
<li><p><strong>freqs</strong> (<em>array</em><em>, </em><em>shape=</em><em>(</em><em>n_freqs</em><em>,</em><em>)</em>) – Frequency bins.</p></li>
<li><p><strong>n_avg</strong> (<em>int</em>) – Number of neighbour bins to estimate noise over. Make sure that this
value doesn’t overlap with neighbouring target frequencies.</p></li>
<li><p><strong>n_harm</strong> (<em>int</em>) – Compute SNR at each frequency bin as a pooled RMS over this bin and
n_harm harmonics (see references below).</p></li>
<li><p><strong>skipbins</strong> (<em>int</em>) – Number of bins skipped to estimate noise of neighbouring bins.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><strong>SNR</strong> – Signal-to-Noise-corrected spectrum.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>ndarray, shape=(n_freqs, n_chans, n_trials) or (n_freqs, n_chans)</p>
</dd>
</dl>
<p class="rubric">References</p>
<div role="list" class="citation-list">
<div class="citation" id="r5f59cf67c005-1" role="doc-biblioentry">
<span class="label"><span class="fn-bracket">[</span>1<span class="fn-bracket">]</span></span>
<p>Cottereau, B. R., McKee, S. P., Ales, J. M., &amp; Norcia, A. M. (2011).
Disparity-tuned population responses from human visual cortex. The
Journal of Neuroscience, 31(3), 954-965.</p>
</div>
<div class="citation" id="r5f59cf67c005-2" role="doc-biblioentry">
<span class="label"><span class="fn-bracket">[</span>2<span class="fn-bracket">]</span></span>
<p>Cottereau, B. R., McKee, S. P., &amp; Norcia, A. M. (2014). Dynamics and
cortical distribution of neural responses to 2D and 3D motion in human.
Journal of neurophysiology, 111(3), 533-543.</p>
</div>
<div class="citation" id="r5f59cf67c005-3" role="doc-biblioentry">
<span class="label"><span class="fn-bracket">[</span>3<span class="fn-bracket">]</span></span>
<p>de Heering, A., &amp; Rossion, B. (2015). Rapid categorization of
natural face images in the infant right hemisphere. Elife, 4.</p>
</div>
</div>
</dd></dl>

<div class="line-block">
<div class="line"><br /></div>
</div>
</section>
<hr class="docutils" />
<section id="module-meegkit.utils.trca">
<span id="trca-utilities"></span><h2>TRCA utilities<a class="headerlink" href="#module-meegkit.utils.trca" title="Link to this heading">#</a></h2>
<p>TRCA utils.</p>
<div class="pst-scrollable-table-container"><table class="autosummary longtable table autosummary">
<tbody>
</tbody>
</table>
</div>
<dl class="py function">
<dt class="sig sig-object py" id="meegkit.utils.trca.bandpass">
<span class="sig-prename descclassname"><span class="pre">meegkit.utils.trca.</span></span><span class="sig-name descname"><span class="pre">bandpass</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">eeg</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">sfreq</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">Wp</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">Ws</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#meegkit.utils.trca.bandpass" title="Link to this definition">#</a></dt>
<dd><p>Filter bank design for decomposing EEG data into sub-band components.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>eeg</strong> (<em>np.array</em><em>, </em><em>shape=</em><em>(</em><em>n_samples</em><em>, </em><em>n_chans</em><em>[</em><em>, </em><em>n_trials</em><em>]</em><em>)</em>) – Training data.</p></li>
<li><p><strong>sfreq</strong> (<em>int</em>) – Sampling frequency of the data.</p></li>
<li><p><strong>Wp</strong> (<em>2-tuple</em>) – Passband for Chebyshev filter.</p></li>
<li><p><strong>Ws</strong> (<em>2-tuple</em>) – Stopband for Chebyshev filter.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><strong>y</strong> – Sub-band components decomposed by a filter bank.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>np.array, shape=(n_trials, n_chans, n_samples)</p>
</dd>
</dl>
<div class="admonition seealso">
<p class="admonition-title">See also</p>
<dl class="simple">
<dt><code class="xref py py-obj docutils literal notranslate"><span class="pre">scipy.signal.cheb1ord</span></code></dt><dd><p>Chebyshev type I filter order selection.</p>
</dd>
</dl>
</div>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="meegkit.utils.trca.itr">
<span class="sig-prename descclassname"><span class="pre">meegkit.utils.trca.</span></span><span class="sig-name descname"><span class="pre">itr</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">n</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">p</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">t</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#meegkit.utils.trca.itr" title="Link to this definition">#</a></dt>
<dd><p>Compute information transfer rate (ITR).</p>
<p>Definition in <a class="reference internal" href="#rf9068fb4bd5d-1" id="id9">[1]</a>.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>n</strong> (<em>int</em>) – Number of targets.</p></li>
<li><p><strong>p</strong> (<em>float</em>) – Target identification accuracy (0 &lt;= p &lt;= 1).</p></li>
<li><p><strong>t</strong> (<em>float</em>) – Average time for a selection (s).</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><strong>itr</strong> – Information transfer rate [bits/min]</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>float</p>
</dd>
</dl>
<p class="rubric">References</p>
<div role="list" class="citation-list">
<div class="citation" id="rf9068fb4bd5d-1" role="doc-biblioentry">
<span class="label"><span class="fn-bracket">[</span><a role="doc-backlink" href="#id9">1</a><span class="fn-bracket">]</span></span>
<p>M. Cheng, X. Gao, S. Gao, and D. Xu,
“Design and Implementation of a Brain-Computer Interface With High
Transfer Rates”, IEEE Trans. Biomed. Eng. 49, 1181-1186, 2002.</p>
</div>
</div>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="meegkit.utils.trca.normfit">
<span class="sig-prename descclassname"><span class="pre">meegkit.utils.trca.</span></span><span class="sig-name descname"><span class="pre">normfit</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">data</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ci</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.95</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#meegkit.utils.trca.normfit" title="Link to this definition">#</a></dt>
<dd><p>Compute the mean, std and confidence interval for them.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>data</strong> (<em>array</em><em>, </em><em>shape=</em><em>(</em><em>)</em>) – Input data.</p></li>
<li><p><strong>ci</strong> (<em>float</em>) – Confidence interval (default=0.95).</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><ul class="simple">
<li><p><strong>m</strong> (<em>float</em>) – Mean.</p></li>
<li><p><strong>sigma</strong> (<em>float</em>) – Standard deviation</p></li>
<li><p><strong>[m - h, m + h]</strong> (<em>list</em>) – Confidence interval of the mean.</p></li>
<li><p><strong>[sigmaCI_lower, sigmaCI_upper]</strong> (<em>list</em>) – Confidence interval of the std.</p></li>
</ul>
</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="meegkit.utils.trca.round_half_up">
<span class="sig-prename descclassname"><span class="pre">meegkit.utils.trca.</span></span><span class="sig-name descname"><span class="pre">round_half_up</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">num</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">decimals</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#meegkit.utils.trca.round_half_up" title="Link to this definition">#</a></dt>
<dd><p>Round half up round the last decimal of the number.</p>
<p>The rules are:
from 0 to 4 rounds down
from 5 to 9 rounds up</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>num</strong> (<em>float</em>) – Number to round</p></li>
<li><p><strong>decimals</strong> (<em>number</em><em> of </em><em>decimals</em>)</p></li>
</ul>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p>num rounded</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="meegkit.utils.trca.schaefer_strimmer_cov">
<span class="sig-prename descclassname"><span class="pre">meegkit.utils.trca.</span></span><span class="sig-name descname"><span class="pre">schaefer_strimmer_cov</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">X</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#meegkit.utils.trca.schaefer_strimmer_cov" title="Link to this definition">#</a></dt>
<dd><p>Schaefer-Strimmer covariance estimator.</p>
<p>Shrinkage estimator described in <a class="reference internal" href="#re057c3ed3876-1" id="id10">[1]</a>:</p>
<div class="math notranslate nohighlight">
\[\hat{\Sigma} = (1 - \gamma)\Sigma_{scm} + \gamma T\]</div>
<p>where <span class="math notranslate nohighlight">\(T\)</span> is the diagonal target matrix:</p>
<div class="math notranslate nohighlight">
\[T_{i,j} = \{ \Sigma_{scm}^{ii} \text{if} i = j,
0 \text{otherwise} \}\]</div>
<p>Note that the optimal <span class="math notranslate nohighlight">\(\gamma\)</span> is estimated by the authors’ method.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>X</strong> (<em>array</em><em>, </em><em>shape=</em><em>(</em><em>n_chans</em><em>, </em><em>n_samples</em><em>)</em>) – Signal matrix.</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><strong>cov</strong> – Schaefer-Strimmer shrinkage covariance matrix.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>array, shape=(n_chans, n_chans)</p>
</dd>
</dl>
<p class="rubric">References</p>
<div role="list" class="citation-list">
<div class="citation" id="re057c3ed3876-1" role="doc-biblioentry">
<span class="label"><span class="fn-bracket">[</span><a role="doc-backlink" href="#id10">1</a><span class="fn-bracket">]</span></span>
<p>Schafer, J., and K. Strimmer. 2005. A shrinkage approach to
large-scale covariance estimation and implications for functional
genomics. Statist. Appl. Genet. Mol. Biol. 4:32.</p>
</div>
</div>
</dd></dl>

</section>
</section>


                </article>
              
              
              
              
              
                <footer class="prev-next-footer d-print-none">
                  
<div class="prev-next-area">
</div>
                </footer>
              
            </div>
            
            
              
                <dialog id="pst-secondary-sidebar-modal"></dialog>
                <div id="pst-secondary-sidebar" class="bd-sidebar-secondary bd-toc"><div class="sidebar-secondary-items sidebar-secondary__inner">


  <div class="sidebar-secondary-item">
<div
    id="pst-page-navigation-heading-2"
    class="page-toc tocsection onthispage">
    <i class="fa-solid fa-list"></i> On this page
  </div>
  <nav class="bd-toc-nav page-toc" aria-labelledby="pst-page-navigation-heading-2">
    <ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#module-meegkit.utils.auditory">Auditory</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#meegkit.utils.auditory.AuditoryFilterbank"><code class="docutils literal notranslate"><span class="pre">AuditoryFilterbank</span></code></a><ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#meegkit.utils.auditory.AuditoryFilterbank.__init__"><code class="docutils literal notranslate"><span class="pre">AuditoryFilterbank.__init__()</span></code></a></li>
</ul>
</li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#meegkit.utils.auditory.GammatoneFilterbank"><code class="docutils literal notranslate"><span class="pre">GammatoneFilterbank</span></code></a><ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#meegkit.utils.auditory.GammatoneFilterbank.__init__"><code class="docutils literal notranslate"><span class="pre">GammatoneFilterbank.__init__()</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#meegkit.utils.auditory.GammatoneFilterbank.filter"><code class="docutils literal notranslate"><span class="pre">GammatoneFilterbank.filter()</span></code></a></li>
</ul>
</li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#meegkit.utils.auditory.erb2hz"><code class="docutils literal notranslate"><span class="pre">erb2hz()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#meegkit.utils.auditory.erb_bandwidth"><code class="docutils literal notranslate"><span class="pre">erb_bandwidth()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#meegkit.utils.auditory.erbspace"><code class="docutils literal notranslate"><span class="pre">erbspace()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#meegkit.utils.auditory.hz2erb"><code class="docutils literal notranslate"><span class="pre">hz2erb()</span></code></a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#module-meegkit.utils.buffer">Buffer</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#meegkit.utils.buffer.Buffer"><code class="docutils literal notranslate"><span class="pre">Buffer</span></code></a><ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#meegkit.utils.buffer.Buffer.size"><code class="docutils literal notranslate"><span class="pre">Buffer.size</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#meegkit.utils.buffer.Buffer.n_channels"><code class="docutils literal notranslate"><span class="pre">Buffer.n_channels</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#meegkit.utils.buffer.Buffer.counter"><code class="docutils literal notranslate"><span class="pre">Buffer.counter</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#meegkit.utils.buffer.Buffer._data"><code class="docutils literal notranslate"><span class="pre">Buffer._data</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#meegkit.utils.buffer.Buffer.__init__"><code class="docutils literal notranslate"><span class="pre">Buffer.__init__()</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#meegkit.utils.buffer.Buffer.get_new_samples"><code class="docutils literal notranslate"><span class="pre">Buffer.get_new_samples()</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#meegkit.utils.buffer.Buffer.head"><code class="docutils literal notranslate"><span class="pre">Buffer.head</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#meegkit.utils.buffer.Buffer.push"><code class="docutils literal notranslate"><span class="pre">Buffer.push()</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#meegkit.utils.buffer.Buffer.reset"><code class="docutils literal notranslate"><span class="pre">Buffer.reset()</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#meegkit.utils.buffer.Buffer.tail"><code class="docutils literal notranslate"><span class="pre">Buffer.tail</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#meegkit.utils.buffer.Buffer.view"><code class="docutils literal notranslate"><span class="pre">Buffer.view()</span></code></a></li>
</ul>
</li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#module-meegkit.utils.coherence">Coherence</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#meegkit.utils.coherence.compute_spectrogram"><code class="docutils literal notranslate"><span class="pre">compute_spectrogram()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#meegkit.utils.coherence.cross_coherence"><code class="docutils literal notranslate"><span class="pre">cross_coherence()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#meegkit.utils.coherence.norm_spectrum"><code class="docutils literal notranslate"><span class="pre">norm_spectrum()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#meegkit.utils.coherence.plot_polycoherence"><code class="docutils literal notranslate"><span class="pre">plot_polycoherence()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#meegkit.utils.coherence.plot_polycoherence_1d"><code class="docutils literal notranslate"><span class="pre">plot_polycoherence_1d()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#meegkit.utils.coherence.plot_signal"><code class="docutils literal notranslate"><span class="pre">plot_signal()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#meegkit.utils.coherence.polycoherence_0d"><code class="docutils literal notranslate"><span class="pre">polycoherence_0d()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#meegkit.utils.coherence.polycoherence_1d"><code class="docutils literal notranslate"><span class="pre">polycoherence_1d()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#meegkit.utils.coherence.polycoherence_1d_sum"><code class="docutils literal notranslate"><span class="pre">polycoherence_1d_sum()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#meegkit.utils.coherence.polycoherence_2d"><code class="docutils literal notranslate"><span class="pre">polycoherence_2d()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#meegkit.utils.coherence.synthetic_signal"><code class="docutils literal notranslate"><span class="pre">synthetic_signal()</span></code></a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#module-meegkit.utils.covariances">Covariances</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#meegkit.utils.covariances.block_covariance"><code class="docutils literal notranslate"><span class="pre">block_covariance()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#meegkit.utils.covariances.convmtx"><code class="docutils literal notranslate"><span class="pre">convmtx()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#meegkit.utils.covariances.cov_lags"><code class="docutils literal notranslate"><span class="pre">cov_lags()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#meegkit.utils.covariances.nonlinear_eigenspace"><code class="docutils literal notranslate"><span class="pre">nonlinear_eigenspace()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#meegkit.utils.covariances.pca"><code class="docutils literal notranslate"><span class="pre">pca()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#meegkit.utils.covariances.regcov"><code class="docutils literal notranslate"><span class="pre">regcov()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#meegkit.utils.covariances.tscov"><code class="docutils literal notranslate"><span class="pre">tscov()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#meegkit.utils.covariances.tsxcov"><code class="docutils literal notranslate"><span class="pre">tsxcov()</span></code></a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#module-meegkit.utils.denoise">Denoising</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#meegkit.utils.denoise.demean"><code class="docutils literal notranslate"><span class="pre">demean()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#meegkit.utils.denoise.find_outlier_samples"><code class="docutils literal notranslate"><span class="pre">find_outlier_samples()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#meegkit.utils.denoise.find_outlier_trials"><code class="docutils literal notranslate"><span class="pre">find_outlier_trials()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#meegkit.utils.denoise.mean_over_trials"><code class="docutils literal notranslate"><span class="pre">mean_over_trials()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#meegkit.utils.denoise.wpwr"><code class="docutils literal notranslate"><span class="pre">wpwr()</span></code></a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#module-meegkit.utils.matrix">Matrix manipulation</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#meegkit.utils.matrix.fold"><code class="docutils literal notranslate"><span class="pre">fold()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#meegkit.utils.matrix.matmul3d"><code class="docutils literal notranslate"><span class="pre">matmul3d()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#meegkit.utils.matrix.multishift"><code class="docutils literal notranslate"><span class="pre">multishift()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#meegkit.utils.matrix.multismooth"><code class="docutils literal notranslate"><span class="pre">multismooth()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#meegkit.utils.matrix.normcol"><code class="docutils literal notranslate"><span class="pre">normcol()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#meegkit.utils.matrix.relshift"><code class="docutils literal notranslate"><span class="pre">relshift()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#meegkit.utils.matrix.shift"><code class="docutils literal notranslate"><span class="pre">shift()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#meegkit.utils.matrix.shiftnd"><code class="docutils literal notranslate"><span class="pre">shiftnd()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#meegkit.utils.matrix.sliding_window"><code class="docutils literal notranslate"><span class="pre">sliding_window()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#meegkit.utils.matrix.theshapeof"><code class="docutils literal notranslate"><span class="pre">theshapeof()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#meegkit.utils.matrix.unfold"><code class="docutils literal notranslate"><span class="pre">unfold()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#meegkit.utils.matrix.unsqueeze"><code class="docutils literal notranslate"><span class="pre">unsqueeze()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#meegkit.utils.matrix.widen_mask"><code class="docutils literal notranslate"><span class="pre">widen_mask()</span></code></a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#module-meegkit.utils.sig">Signal</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#meegkit.utils.sig.gaussfilt"><code class="docutils literal notranslate"><span class="pre">gaussfilt()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#meegkit.utils.sig.hilbert_envelope"><code class="docutils literal notranslate"><span class="pre">hilbert_envelope()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#meegkit.utils.sig.lowpass_env_filtering"><code class="docutils literal notranslate"><span class="pre">lowpass_env_filtering()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#meegkit.utils.sig.modulation_index"><code class="docutils literal notranslate"><span class="pre">modulation_index()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#meegkit.utils.sig.prony"><code class="docutils literal notranslate"><span class="pre">prony()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#meegkit.utils.sig.slope_sum"><code class="docutils literal notranslate"><span class="pre">slope_sum()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#meegkit.utils.sig.smooth"><code class="docutils literal notranslate"><span class="pre">smooth()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#meegkit.utils.sig.spectral_envelope"><code class="docutils literal notranslate"><span class="pre">spectral_envelope()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#meegkit.utils.sig.stmcb"><code class="docutils literal notranslate"><span class="pre">stmcb()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#meegkit.utils.sig.teager_kaiser"><code class="docutils literal notranslate"><span class="pre">teager_kaiser()</span></code></a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#module-meegkit.utils.stats">Statistics</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#meegkit.utils.stats.bootstrap_ci"><code class="docutils literal notranslate"><span class="pre">bootstrap_ci()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#meegkit.utils.stats.bootstrap_snr"><code class="docutils literal notranslate"><span class="pre">bootstrap_snr()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#meegkit.utils.stats.cronbach"><code class="docutils literal notranslate"><span class="pre">cronbach()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#meegkit.utils.stats.rms"><code class="docutils literal notranslate"><span class="pre">rms()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#meegkit.utils.stats.robust_mean"><code class="docutils literal notranslate"><span class="pre">robust_mean()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#meegkit.utils.stats.rolling_corr"><code class="docutils literal notranslate"><span class="pre">rolling_corr()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#meegkit.utils.stats.snr_spectrum"><code class="docutils literal notranslate"><span class="pre">snr_spectrum()</span></code></a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#module-meegkit.utils.trca">TRCA utilities</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#meegkit.utils.trca.bandpass"><code class="docutils literal notranslate"><span class="pre">bandpass()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#meegkit.utils.trca.itr"><code class="docutils literal notranslate"><span class="pre">itr()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#meegkit.utils.trca.normfit"><code class="docutils literal notranslate"><span class="pre">normfit()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#meegkit.utils.trca.round_half_up"><code class="docutils literal notranslate"><span class="pre">round_half_up()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#meegkit.utils.trca.schaefer_strimmer_cov"><code class="docutils literal notranslate"><span class="pre">schaefer_strimmer_cov()</span></code></a></li>
</ul>
</li>
</ul>
  </nav></div>

  <div class="sidebar-secondary-item">

  
  <div class="tocsection editthispage">
    <a href="https://github.com/nbara/python-meegkit/edit/master/doc/modules/meegkit.utils.rst">
      <i class="fa-solid fa-pencil"></i>
      
      
        
          Edit on GitHub
        
      
    </a>
  </div>
</div>

  <div class="sidebar-secondary-item">
  <div role="note" aria-label="source link">
    <h3>This Page</h3>
    <ul class="this-page-menu">
      <li><a href="../_sources/modules/meegkit.utils.rst.txt"
            rel="nofollow">Show Source</a></li>
    </ul>
   </div></div>

</div></div>
              
            
          </div>
          <footer class="bd-footer-content">
            
          </footer>
        
      </main>
    </div>
  </div>
  
  <!-- Scripts loaded after <body> so the DOM is not blocked -->
  <script defer src="../_static/scripts/bootstrap.js?digest=8878045cc6db502f8baf"></script>
<script defer src="../_static/scripts/pydata-sphinx-theme.js?digest=8878045cc6db502f8baf"></script>

  <footer class="bd-footer">
<div class="bd-footer__inner bd-page-width">
  
    <div class="footer-items__start">
      
        <div class="footer-item">

  <p class="copyright">
    
      © Copyright 2024, Nicolas Barascud.
      <br/>
    
  </p>
</div>
      
        <div class="footer-item">

  <p class="sphinx-version">
    Created using <a href="https://www.sphinx-doc.org/">Sphinx</a> 8.1.3.
    <br/>
  </p>
</div>
      
    </div>
  
  
  
    <div class="footer-items__end">
      
        <div class="footer-item">
<p class="theme-version">
  <!-- # L10n: Setting the PST URL as an argument as this does not need to be localized -->
  Built with the <a href="https://pydata-sphinx-theme.readthedocs.io/en/stable/index.html">PyData Sphinx Theme</a> 0.16.1.
</p></div>
      
    </div>
  
</div>

  </footer>
  </body>
</html>